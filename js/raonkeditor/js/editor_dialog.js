var G_IMAGE_ALLOW_EXT=["jpg","jpeg","png","gif","bmp"],G_dragDropFileObj=null,LayerFrame=KEDITORTOP.KEDITORDOC.getElementById("raonk_frame_"+KEDITORTOP.G_CURRKEDITOR.ID),LayerWin=LayerFrame.contentWindow,LayerDoc=LayerWin.document;
try{HTMLCanvasElement&&!HTMLCanvasElement.prototype.toBlob&&Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(a,c,d){var b=this;setTimeout(function(){for(var e=atob(b.toDataURL(c,d).split(",")[1]),g=e.length,f=new Uint8Array(g),h=0;h<g;h++)f[h]=e.charCodeAt(h);a(new Blob([f],{type:c||"image/png"}))})}})}catch(e$$4){}
function keditor_setting(){var a=document.getElementById("grid_color").style.backgroundColor,c=document.getElementById("grid_color_name").innerHTML,d=document.getElementById("lang").value,b=document.getElementById("grid_spans").value,e=document.getElementsByName("grid_form")[0].checked?"line":"dot",g=document.getElementById("page_title").value,f=document.getElementById("encoding").value,h=document.getElementById("doctype").value,k=document.getElementById("xhtml").checked?document.getElementById("xhtml").value:
"",l=document.getElementById("check_auto_list").checked,m=document.getElementById("check_auto_save").checked,p=document.getElementById("input_auto_save").value,p="none"!=document.getElementById("div_auto_save").style.display?m?""!=p&&"0"!=p?"1,"+document.getElementById("input_auto_save").value:"2":"2":"0",l=l?"1":"0",m=LayerWin._k_editor._config.accessibility;if("1"==m)""==g&&alert(LayerWin.RAONKEditor_lang.msg.alert_page_title_access1);else if("2"==m&&""==g){alert(LayerWin.RAONKEditor_lang.msg.alert_page_title_access2);
document.getElementById("page_title").focus();return}var m=document.getElementById("check_ruler").checked,n=document.getElementById("ruler_px").value;""!=n&&("2"==LayerWin._k_editor._config.ruler.mode?LayerWin._k_editor.isInitBodyAutoFit=!0:(n=n.split(","),n=n.sort(function(a,b){return a-b}),n=n.join(",")));var m=m?"1":"0",q=document.getElementById("personal_font_family").value,r=document.getElementById("personal_font_size").value,t=document.getElementById("personal_line_height").value,u=document.getElementById("word_break").value,
y=document.getElementById("word_wrap").value,v=document.getElementById("check_apply_word_break_for_table").checked;dataJson={grid_color:a,grid_color_nm:c,grid_spans:b,grid_form:e,page_title:g,encoding:f,lang:d,doctype:h,xhtml:k,auto_save:p,ruler:m,ruler_px:n,auto_list:l,personal_font_family:q,personal_font_size:r,personal_line_height:t,word_break_type:u,word_wrap_type:y,word_break_for_all_table:v};LayerWin.event_keditor_setting(dataJson,window.frameElement.parentNode.parentNode)}
function keditor_horizontal_line(a,c){var d;if(!a){d=document.getElementById("width_1").value;var b=document.getElementById("height").value,e=document.getElementById("align").value,g=document.getElementById("hr_color").style.borderTopColor;d={width:d,height:b,align:e,color:g}}LayerWin.event_keditor_horizontal_line(d,a,c,window.frameElement.parentNode.parentNode)}
function loading_image_show(a){var c=document.getElementById("keditor_loading"),d="";0==a?(d="none",document.body.style.cursor="default"):document.body.style.cursor="wait";c&&(c.style.display=d);"1"==LayerWin._k_editor._config.uploadUseHTML5&&a&&c&&c.childNodes&&(c.childNodes[1].nodeValue=" Uploading... ")}function web_url_remove_char(a){a=a.replace(/(\r\n|\r|\n)/gm,"");a=a.replace(/&#13;/g,"");a=a.replace(/&#10;/g,"");return a=a.replace(/&#32;/g,"")}
function keditor_upload_image(){var a=document.keditor_upload_form,c=0,d;""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?(c=G_dragDropFileObj.length,d={value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}):d={value:""}:d=document.getElementById(file_field_id);var b=document.getElementById("img_web_url");null==b&&(b="");var e=document.getElementById("link_url");null==e&&(e="");var g=LayerWin.getElementsByClass("EdiTor_Popup_contents",
document),f=/^\s\s*$/;if(!f.exec(e.value)&&""!=e.value){var f=new RegExp(/^(http|ftp|https|news)/),h=f.test(e.value);if("http://"==e.value)e.value="";else if(h&&!KEDITORTOP.RAONKEDITOR.util.checkUrl(e.value)){alert(LayerWin.RAONKEditor_lang.msg.alert_url);g[0].className="EdiTor_Popup_contents none";g[1].className="EdiTor_Popup_contents view";LayerWin.lastFocus(e);return}}e=[];if(document.getElementsByName("InputFlag")[0].checked){if("1"==LayerWin._k_editor._config.useKManager)for(b=0;b<c;b++)e.push(G_dragDropFileObj[b].path);
else e.push(d.value);g=e.length;for(b=0;b<g;b++)if(0<e[b].lastIndexOf(".")){f=LayerWin._k_editor._config.accessibility;h=document.getElementById("img_alt").value;if("1"==f)""==h&&alert(LayerWin.RAONKEditor_lang.msg.alert_image_alt_access1);else if("2"==f&&""==h){alert(LayerWin.RAONKEditor_lang.msg.alert_image_alt_access2);document.getElementById("img_alt").focus();break}for(var f=e[b].substring(e[b].lastIndexOf(".")+1).toLowerCase(),h=!1,k=LayerWin._k_editor._config.allowImageFileType,l=k.toString()+
LayerWin.RAONKEditor_lang.msg.alert_exec_tail,m=k.length,p=0;p<m;p++)if(f==k[p]){h=!0;break}if(1==h)if("base64"==LayerWin._k_editor._config.uploadMethod)if("1"==LayerWin._k_editor._config.useKManager||"1"==LayerWin._k_editor._config.uploadUseHTML5)if(f=G_dragDropFileObj[b],"1"==LayerWin._k_editor._config.useKManager)h=function(a){var b=new Image;b.onload=function(){var c=b.width,d=b.height;b=void 0;a+="?"+c+"^"+d;event_keditor_image_upload_completed(a)};b.src=a},f={localPath:f.path,fn_callback:h},
LayerWin.localImageToBase64(f);else{var n=new FileReader;n.onload=function(){var a=n.result,b=new Image;b.onload=function(){a+="?"+b.width+"^"+b.height;event_keditor_image_upload_completed(a)};b.src=a;n=void 0};n.readAsDataURL(f)}else f=d.files[b],h=function(a){var b=new Image;b.onload=function(){var c=b.width,d=b.height;b=void 0;a+="?"+c+"^"+d;event_keditor_image_upload_completed(a)};b.src=a},f={localPath:f.path,fn_callback:h},LayerWin.localImageToBase64(f);else if("1"==LayerWin._k_editor._config.useKManager)e[b]=
LayerWin.convertImageAgentSrc("file:///"+e[b],!0),e[b]+="?"+g_curr_width[b]+"^"+g_curr_height[b],f=!0,b==c-1&&(f=!1),event_keditor_image_upload_completed(e[b],f);else if(loading_image_show(!0),"1"==LayerWin._k_editor._config.uploadUseHTML5){f=new KEDITORTOP.RAONKEDITOR.util.hashTable;h="";h+="kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical;h+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical;
h+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+e[b].substring(e[b].lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;h+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;h+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;h+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;h=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(h);
f.setItem("k00",h);h=LayerWin.G_FormData.length;for(k=0;k<h;k++)l=LayerWin.G_FormData[k].form_value,l="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(l):encodeURIComponent(l),f.setItem(LayerWin.G_FormData[k].form_name,l);uploadAjaxOnprogressStart({uploadType:"image",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:d.id,fileObj:G_dragDropFileObj,formData:f},event_keditor_image_upload_completed)}else a.action=document.getElementById("upload_url").value,
a.submit();else{alert(l);break}}else{""==e[b]?alert(LayerWin.RAONKEditor_lang.msg.alert_no_file):alert(LayerWin.RAONKEditor_lang.msg.alert_exec);break}}else e.push(b.value),f=new RegExp(/^(http|ftp|https|news)/),h=f.test(e[0]),f=/^\s\s*$/,""==e[0]||f.exec(e[0])||h&&!KEDITORTOP.RAONKEDITOR.util.checkUrl(e[0])?(alert(LayerWin.RAONKEditor_lang.msg.alert_url),b.focus()):event_keditor_image_upload_completed(e[0])}
function event_keditor_image_link(){var a=document.getElementById("img_web_url").value,c=document.getElementById("img_width").value,d=document.getElementById("img_height").value,b=document.getElementById("img_alt").value,e=document.getElementById("img_title").value,g=document.getElementById("img_v_space").value,f=document.getElementById("img_h_space").value,h=document.getElementById("img_align"),h=h.options[h.selectedIndex].value,k="";document.getElementById("img_border")&&(k=document.getElementById("img_border").value);
var l=document.getElementById("link_url").value,m=document.getElementById("link_title").value,p=document.getElementById("link_target").value;LayerWin.event_keditor_image_upload("","","","0",a,0,0,b,"",{srcURL:a,width:c,height:d,title:e,alt:b,vspace:g,hspace:f,align:h,border:k,linkurl:l,linktitle:m,linktarget:p},window.frameElement.parentNode.parentNode)}
function event_keditor_image_upload_completed(a,c){var d=!1;document.getElementsByName("InputFlag")[1]&&(d=document.getElementsByName("InputFlag")[1].checked);"base64"!=LayerWin._k_editor._config.uploadMethod&&a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));var b=document.getElementById("img_width").value,e=document.getElementById("img_height").value;if(!d){var g=0,f=0;if(null!=a&&void 0!=a){try{var h={strUrl:a},k;k="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?
KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,h):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,h);null!=k&&void 0!=k&&(a=k)}catch(l){}var m=[];"0"!=LayerWin._k_editor._config.imageCustomPropertyDelimiter&&(m=a.split(LayerWin._k_editor._config.imageCustomPropertyDelimiter),1<m.length&&(a=m[0]));k=a.split("?");2==k.length&&(a=k[0],k=k[1].split("^"),2==k.length?(g=k[0],f=k[1]):3==k.length&&(g=k[0],f=k[1],a+="?"+k[2]));"1"==LayerWin._k_editor._config.useKManager&&
(0!=b.length&&(g=b),0!=e.length&&(f=e));if(elemModify&&"img"==elemModify.tagName.toLowerCase()){"[FAIL]"==a.substring(0,6)?(elemModify.src=LayerWin._k_editor._config.webPath.image+"dialog/image_xbox.jpg",elemModify.setAttribute("alt",a.substring(6,a.length).replace(/"/g,"'"))):elemModify.src=a;"function"==typeof G_UploadCompleteCallBackFn&&G_UploadCompleteCallBackFn();return}k=!1;document.getElementById("original_size")&&(k=document.getElementById("original_size").checked);if(!k)if(k=LayerWin.getWidthForAutoBodyFit(LayerWin._k_editor,
"img"),"1"==LayerWin._k_editor._config.imageAutoConvert){k=LayerWin.KEDITORTOP.RAONKEDITOR.util.parseIntOr0(LayerWin._k_editor._config.image_convert_width);var p=LayerWin.KEDITORTOP.RAONKEDITOR.util.parseIntOr0(LayerWin._k_editor._config.image_convert_height),n=!1,q=!1,g=LayerWin.KEDITORTOP.RAONKEDITOR.util.parseIntOr0(g),f=LayerWin.KEDITORTOP.RAONKEDITOR.util.parseIntOr0(f);if(0!=k&&0==p)g>k&&(n=!0);else if(0==k&&0!=p)f>p&&(q=!0);else{var r=1*k/g,t=1*p/f;r<t?1>r&&(n=!0):1>t&&(q=!0)}n?(n=k/g,g=k,
f=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(n*f)):q&&(n=p/f,f=p,g=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(n*g))}else"1"==LayerWin._k_editor._config.image_auto_fit&&g>k?(n=k/g,g=k,f*=n,b>g&&(b=g,e=f)):"2"==LayerWin._k_editor._config.image_auto_fit&&(g>k||f>LayerWin._k_editor._defaultHeight)&&(b=LayerWin._k_editor._defaultHeight,e=b/k,p=f/g,p>e?f>b?(e=b,b=Math.round(g*e/f)):(b=g,e=f):p<e?g>k?(b=k,e=Math.round(f*b/g)):(b=g,e=f):(b=g,e=f))}"1"==LayerWin._k_editor._config.useKManager?(b=parseInt(g),e=parseInt(f)):
0==b.length&&0<g&&(b=parseInt(g),e=parseInt(f),f=g="",k=!1,document.getElementById("original_size")&&(k=document.getElementById("original_size").checked),k||(g=LayerWin._k_editor._config.imgDefaultWidth,f=LayerWin._k_editor._config.imgDefaultHeight),""!=g?KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b)>KEDITORTOP.RAONKEDITOR.util.parseIntOr0(g)&&(b=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(e,10)*KEDITORTOP.RAONKEDITOR.util.parseIntOr0(g,10)/KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b,10),e=isNaN(b)?e:Math.round(b),
b=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(g)):""!=f&&KEDITORTOP.RAONKEDITOR.util.parseIntOr0(e)>KEDITORTOP.RAONKEDITOR.util.parseIntOr0(f)&&(e=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b,10)*KEDITORTOP.RAONKEDITOR.util.parseIntOr0(f,10)/KEDITORTOP.RAONKEDITOR.util.parseIntOr0(e,10),b=isNaN(e)?b:Math.round(e),e=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(f)));loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(h={strType:"imageUpload",strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?
KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,h):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,h)))return}catch(u){}if(!d&&"[FAIL]"==a.substring(0,6)&&"base64"!=LayerWin._k_editor._config.uploadMethod){confirm(LayerWin.RAONKEditor_lang.msg.uploadFailed)&&alert(a);return}a=web_url_remove_char(a)}var h=a,g=document.getElementById("img_alt").value,t=document.getElementById("img_title").value,y="",v="",w="";try{y=document.getElementById("img_id").value,
v=document.getElementById("img_class").value,w=document.getElementById("img_figure").checked}catch(z){}f=document.getElementById("img_margin_left").value;k=document.getElementById("img_margin_right").value;p=document.getElementById("img_margin_top").value;n=document.getElementById("img_margin_bottom").value;f="-"==f?"":f;k="-"==k?"":k;p="-"==p?"":p;n="-"==n?"":n;q=document.getElementById("img_align");q=q.options[q.selectedIndex].value;r="";document.getElementById("img_border")&&(r=document.getElementById("img_border").value);
var x=!1;document.getElementById("continue_insert")&&(x=document.getElementById("continue_insert").checked);c&&(x=!0);var B="";document.getElementById("link_url")&&(B=document.getElementById("link_url").value);var D="";document.getElementById("link_title")&&(D=document.getElementById("link_title").value);var C="";document.getElementById("link_target")&&(C=document.getElementById("link_target").value);var A="",J="",K="",G="";document.getElementById("line_style")&&(A=document.getElementById("line_style").style.borderTopStyle,
"none"!=A&&(J=document.getElementById("line_kind").value,K=document.getElementById("line_color").style.borderTopColor,G=document.getElementById("line_thickness").value));var L=!1;document.getElementById("image_spacing")&&(L=document.getElementById("image_spacing").checked);var H="px",E="px",I=document.getElementById("img_width_unit"),F=document.getElementById("img_height_unit");I&&""!=I.value&&(H=I.value);F&&""!=F.value&&(E=F.value);if("%"==H||"%"==E)b=document.getElementById("img_width").value,e=
document.getElementById("img_height").value;d={srcURL:a,width:b,height:e,title:t,id:y,className:v,figure:w,alt:g,margin_left:f,margin_right:k,margin_top:p,margin_bottom:n,align:q,border:r,linkurl:B,linktitle:D,linktarget:C,continueInsert:x,input_url_checked:d,img_attr_info_arr:m,input_url_checked:d,borderStyle:A,borderKind:J,borderColor:K,borderThickness:G,imageSpacing:L,widthUnit:H,heightUnit:E};m=""+("<img style='width:"+b+"px; height:"+e+"px;");0<p.length&&!isNaN(p)&&(m+=" margin-top:"+p+"px;");
0<k.length&&!isNaN(k)&&(m+=" margin-right:"+k+"px;");0<n.length&&!isNaN(n)&&(m+=" margin-bottom:"+n+"px;");0<f.length&&!isNaN(f)&&(m+=" margin-left:"+f+"px;");m=m+" ' "+(" src='"+h+"'");m+=" alt='"+g+"'";0<q.length&&(m+=" align='"+q+"'");0<r.length&&!isNaN(r)&&(m+=" border='"+r+"'");m+=" />";LayerWin.event_keditor_image_upload("","","0",h,b,e,g,m,d,window.frameElement.parentNode.parentNode)}
function keditor_upload_flash(){if(1==document.getElementById("cb_tag_insert").checked){var a=document.getElementById("ta_flash_tag").value,c=document.createElement("div");c.innerHTML=a;c=c.getElementsByTagName("EMBED")[0];if(null==c)alert(LayerWin.RAONKEditor_lang.flash.invalid_tag);else{var a=null,d=c.getAttribute("scale")?c.getAttribute("scale"):"",b=c.getAttribute("allowScriptAccess")?c.getAttribute("allowScriptAccess"):"",e=c.getAttribute("quality")?c.getAttribute("quality"):"",g=c.getAttribute("align")?
c.getAttribute("align"):"",f,h,k,l;f=null==c.getAttribute("menu")||void 0==c.getAttribute("menu")?!0:0==c.getAttribute("menu")||"false"==c.getAttribute("menu")?!1:!0;h=null==c.getAttribute("play")||void 0==c.getAttribute("play")?!0:0==c.getAttribute("play")||"false"==c.getAttribute("play")?!1:!0;k=null==c.getAttribute("loop")||void 0==c.getAttribute("loop")?!0:0==c.getAttribute("loop")||"false"==c.getAttribute("loop")?!1:!0;null==c.getAttribute("allowFullScreen")||void 0==c.getAttribute("allowFullScreen")?
l=!0:0==c.getAttribute("allowFullScreen")||"false"==c.getAttribute("allowFullScreen")?_allowFullScreenu=!1:l=!0;var m=c.getAttribute("flashvars")?c.getAttribute("flashvars"):"";"embed"==c.tagName.toLowerCase()&&(a={type:"flash",src:c.src,width:0==LayerWin.parseIntOr0(c.style.width)?LayerWin.parseIntOr0(c.width):LayerWin.parseIntOr0(c.style.width),height:0==LayerWin.parseIntOr0(c.style.height)?LayerWin.parseIntOr0(c.height):LayerWin.parseIntOr0(c.style.height),hspace:LayerWin.parseIntOr0(c.getAttribute("hspace")),
vspace:LayerWin.parseIntOr0(c.getAttribute("vspace")),scale:d,allowScriptAccess:b,quality:e,align:g,menu:f,play:h,loop:k,allowFullScreen:l,flashvars:m},l=LayerWin.getLinkMediaType(a.src),0<l.length&&(a.type=l,a.type2="flash"));LayerWin.event_keditor_media_upload("","","","","","",a,window.frameElement.parentNode.parentNode)}}else if(c=document.keditor_upload_form,l="","1"==LayerWin._k_editor._config.useKManager?G_dragDropFileObj&&G_dragDropFileObj[0]&&(a=G_dragDropFileObj[0].path):(l="1"==LayerWin._k_editor._config.uploadUseHTML5?
document.getElementById("file_text"):document.getElementById(file_field_id),a=l.value),d=document.getElementById("web_url"),document.getElementsByName("InputFlag")[0].checked)if(0<a.lastIndexOf(".")){d=a.substring(a.lastIndexOf(".")+1).toLowerCase();b=!1;e=LayerWin._k_editor._config.allowFlashFileType;g=e.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail;for(f=0;f<e.length;f++)if(d==e[f]){b=!0;break}if(1==b)if(loading_image_show(!0),"1"==LayerWin._k_editor._config.useKManager)l=function(a){event_keditor_flash_upload_completed(a[0].path)},
c=[],a={guid:"cid:"+KEDITORTOP.RAONKEDITOR.util.makeGuid(),path:a,callback:l},c.push(a),LayerWin.agentFileUpload(LayerWin._k_editor,c,l);else if("1"==LayerWin._k_editor._config.uploadUseHTML5){c=new KEDITORTOP.RAONKEDITOR.util.hashTable;d=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);d+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical;d+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+
a.substring(a.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;d+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;d+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;d+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;d=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(d);c.setItem("k00",d);a=LayerWin.G_FormData.length;for(d=0;d<
a;d++)b=LayerWin.G_FormData[d].form_value,b="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(b):encodeURIComponent(b),c.setItem(LayerWin.G_FormData[d].form_name,b);uploadAjaxOnprogressStart({uploadType:"flash",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:l.name,fileObj:G_dragDropFileObj,formData:c},event_keditor_flash_upload_completed)}else c.action=document.getElementById("upload_url").value,c.submit();else alert(g)}else""==a?alert(LayerWin.RAONKEditor_lang.msg.alert_no_file):
alert(LayerWin.RAONKEditor_lang.msg.alert_exec);else a=d.value,l=(new RegExp(/^(http|ftp|https|news)/)).test(a),c=/^\s\s*$/,""==a||c.exec(a)||l&&!KEDITORTOP.RAONKEDITOR.util.checkUrl(a)?(alert(LayerWin.RAONKEditor_lang.msg.alert_url),d.focus()):event_keditor_flash_upload_completed(a)}
function event_keditor_flash_upload_completed(a){a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));var c=[];if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var d={strUrl:a},b;b="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d);null!=b&&void 0!=b&&(a=b)}catch(e){}c=
[];"0"!=LayerWin._k_editor._config.imageCustomPropertyDelimiter&&(c=a.split(LayerWin._k_editor._config.imageCustomPropertyDelimiter),1<c.length&&(a=c[0]));b=a.split("?");2==b.length&&-1<b[1].indexOf("^")&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(d={strType:"flashUpload",strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,
d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,d)))return}catch(g){}if("[FAIL]"==a.substring(0,6)){confirm(LayerWin.RAONKEditor_lang.msg.uploadFailed)&&alert(a);return}if(elemModify){elemData.src=a;"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}var f=document.getElementById("flash_width").value,h=document.getElementById("flash_height").value,d=document.getElementById("flash_margin_left").value;
b=document.getElementById("flash_margin_right").value;var k=document.getElementById("flash_margin_top").value,l=document.getElementById("flash_margin_bottom").value,m=document.getElementById("flash_scale").value,p=document.getElementById("flash_allowScriptAccess").value,n=document.getElementById("flash_quality").value,q=document.getElementById("flash_menu").checked,r=document.getElementById("flash_play").checked,t=document.getElementById("flash_loop").checked,u=document.getElementById("flash_allowFullScreen").checked,
y=document.getElementById("flash_width_unit"),v=document.getElementById("flash_height_unit"),y=0==LayerWin.parseIntOr0(f)?"":f+y.value,v=0==LayerWin.parseIntOr0(h)?"":h+v.value;LayerWin.insertElementsSrc(KEDITORTOP.G_CURRKEDITOR,a);c={type:"flash",src:a,width:y,height:v,margin_left:d,margin_right:b,margin_top:k,margin_bottom:l,scale:m,allowScriptAccess:p,quality:n,img_attr_info_arr:c,menu:q,play:r,loop:t,allowFullScreen:u};f=""+("<embed style='width:"+f+"; height:"+h+"; ");""!=d&&(f+="margin-left:"+
d+"; ");""!=b&&(f+="margin-right:"+b+"; ");""!=k&&(f+="margin-top:"+k+"; ");""!=l&&(f+="margin-bottom:"+l+"; ");f=f+"'"+("src='"+a+"'");""!=m&&(f+="scale='"+m+"'");""!=p&&(f+="allowScriptAccess='"+p+"'");""!=n&&(f+="quality='"+n+"'");0==q&&(f+="menu='false'");0==r&&(f+="play='false'");0==t&&(f+="loop='false'");0==u&&(f+="allowFullScreen='false'");f+='wmode="transparent"';f+=" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />";LayerWin.event_keditor_media_upload("",
"","",a,f,c,window.frameElement.parentNode.parentNode)}
function keditor_upload_media(){var a=document.keditor_upload_form,c="",d="";"1"==LayerWin._k_editor._config.useKManager?G_dragDropFileObj&&G_dragDropFileObj[0]&&(d=G_dragDropFileObj[0].path):(c="1"==LayerWin._k_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),d=c.value);var b=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(0<d.lastIndexOf(".")){for(var b=d.substring(d.lastIndexOf(".")+1).toLowerCase(),
e=!1,g=LayerWin._k_editor._config.allowMediaFileType,f=g.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,h=g.length,k=0;k<h;k++)if(b==g[k]){e=!0;break}if(1==e)if(loading_image_show(!0),"1"==LayerWin._k_editor._config.useKManager)c=function(a){event_keditor_media_upload_completed(a[0].path)},a=[],d={guid:"cid:"+KEDITORTOP.RAONKEDITOR.util.makeGuid(),path:d,callback:c},a.push(d),LayerWin.agentFileUpload(LayerWin._k_editor,a,c);else if("1"==LayerWin._k_editor._config.uploadUseHTML5){a=new KEDITORTOP.RAONKEDITOR.util.hashTable;
b=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);b+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+d.substring(d.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;b+=
"k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;b=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(b);a.setItem("k00",b);d=LayerWin.G_FormData.length;for(b=0;b<d;b++)e=LayerWin.G_FormData[b].form_value,e="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(e):encodeURIComponent(e),a.setItem(LayerWin.G_FormData[b].form_name,
e);uploadAjaxOnprogressStart({uploadType:"media",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:c.name,fileObj:G_dragDropFileObj,formData:a},event_keditor_media_upload_completed)}else a.action=document.getElementById("upload_url").value,a.submit();else alert(f)}else""==d?alert(LayerWin.RAONKEditor_lang.msg.alert_no_file):alert(LayerWin.RAONKEditor_lang.msg.alert_exec);else d=b.value,c=new RegExp(/(http|https|mms):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/),a=(new RegExp(/^(http|https|mms)/)).test(d),
e=/^\s\s*$/,""==d||e.exec(d)||a&&!c.test(d)?(alert(LayerWin.RAONKEditor_lang.msg.alert_url),b.focus()):event_keditor_media_upload_completed(d)}function event_keditor_flash_flash_upload_completed(a,c,d){LayerWin.event_keditor_media_upload(a,"","","0",c,d,{type:"flash",src:c,width:300,height:300,hspace:"",vspace:"",scale:"",allowScriptAccess:"",quality:"",align:"",menu:"",play:"",loop:"",allowFullScreen:""},window.frameElement.parentNode.parentNode)}
function event_keditor_flash_media_upload_completed(a,c,d){LayerWin.event_keditor_media_upload(a,"","","0",c,d,{type:"media",src:c,width:300,height:300,autoStart:!1,playCount:!1,showTracker:!1,showStatusBar:!1,showControls:!1,showAudioControls:!1,showDisplay:!1,showPositionControls:!1},window.frameElement.parentNode.parentNode)}
function event_keditor_media_upload_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));e=[];if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var c={strUrl:a},d;d="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,c):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,c);null!=d&&void 0!=
d&&(a=d)}catch(b){}var e=[];"0"!=LayerWin._k_editor._config.imageCustomPropertyDelimiter&&(e=a.split(LayerWin._k_editor._config.imageCustomPropertyDelimiter),1<e.length&&(a=e[0]));d=a.split("?");2==d.length&&-1<d[1].indexOf("^")&&(a=d[0],d=d[1].split("^"),3==d.length&&(a+="?"+d[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(c={strType:"mediaUpload",strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,
c):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,c)))return}catch(g){}if("[FAIL]"==a.substring(0,6)){confirm(LayerWin.RAONKEditor_lang.msg.uploadFailed)&&alert(a);return}if(elemModify){elemData.src=a;"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));return}}c=document.getElementById("media_width").value;d=document.getElementById("media_height").value;var f=document.getElementById("media_width_unit"),
h=document.getElementById("media_height_unit"),c=0==LayerWin.parseIntOr0(c)?"":c+f.value;d=0==LayerWin.parseIntOr0(d)?"":d+h.value;LayerWin.insertElementsSrc(KEDITORTOP.G_CURRKEDITOR,a);e={type:"media",src:a,width:c,height:d,autoStart:document.getElementById("cb_autostart").checked,playCount:document.getElementById("cb_loop").checked,showTracker:document.getElementById("cb_tracker").checked,showStatusBar:document.getElementById("cb_status").checked,showControls:document.getElementById("cb_controls").checked,
showAudioControls:document.getElementById("cb_volumn").checked,showDisplay:document.getElementById("cb_display").checked,showPositionControls:document.getElementById("cb_position").checked,img_attr_info_arr:e};h="";c=""+("<embed style='width:"+c+"; height:"+d+";' ")+" type=application/x-mplayer2 ";c+=" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ";c+=" src='"+a+"'";h=1==document.getElementById("cb_autostart").checked?"1":"0";c+=" AutoStart='"+h+"'";h=1==document.getElementById("cb_loop").checked?
"1":"0";c+=" loop='"+h+"'";h=1==document.getElementById("cb_tracker").checked?"1":"0";c+=" ShowTracker='"+h+"'";h=1==document.getElementById("cb_status").checked?"1":"0";c+=" ShowStatusBar='"+h+"'";h=1==document.getElementById("cb_controls").checked?"1":"0";c+=" ShowControls='"+h+"'";h=1==document.getElementById("cb_volumn").checked?"1":"0";c+=" ShowAudioControls='"+h+"'";h=1==document.getElementById("cb_display").checked?"1":"0";c+=" ShowDisplay='"+h+"'";h=1==document.getElementById("cb_position").checked?
"1":"0";c+=" ShowPositionControls='"+h+"'";c+=" />";LayerWin.event_keditor_media_upload("","","0",a,c,e,window.frameElement.parentNode.parentNode)}
function keditor_detail_table_upload_image(){var a=document.getElementById("tab_value").value,c=LayerWin._k_editor._config.accessibility,d=document.getElementById("table_caption").value,b=document.getElementById("table_summary").value,e="N";1==document.getElementById("scope").checked&&(e="Y");var g="N";1==document.getElementById("t_scope").checked&&(g="Y");var f=document.getElementById("title_cell").value;if("1"==c)"3"!=a&&"4"!=a?(""==d&&alert(LayerWin.RAONKEditor_lang.msg.alert_table_caption_access1),
""==b&&alert(LayerWin.RAONKEditor_lang.msg.alert_table_summary_access1),"1"!=f&&"N"==e&&alert(LayerWin.RAONKEditor_lang.msg.alert_scope_access1)):"3"==a&&"N"==g&&alert(LayerWin.RAONKEditor_lang.msg.alert_scope_access1);else if("2"==c)if("3"!=a&&"4"!=a){if(""==d){alert(LayerWin.RAONKEditor_lang.msg.alert_table_caption_access2);document.getElementById("table_caption").focus();return}if(""==b){alert(LayerWin.RAONKEditor_lang.msg.alert_table_summary_access2);document.getElementById("table_summary").focus();
return}if("1"!=f&&"N"==e){alert(LayerWin.RAONKEditor_lang.msg.alert_scope_access2);document.getElementById("scope").focus();return}}else if("3"==a&&"N"==g){alert(LayerWin.RAONKEditor_lang.msg.alert_scope_access2);document.getElementById("t_scope").focus();return}b=document.keditor_upload_form;d=c="";if("1"==LayerWin._k_editor._config.useKManager)G_dragDropFileObj&&G_dragDropFileObj[0]&&(d=G_dragDropFileObj[0].path);else if(c="1"==LayerWin._k_editor._config.uploadUseHTML5?document.getElementById("file_text"):
document.getElementById(file_field_id))d=c.value;e=d.lastIndexOf(".");if("3"!=a&&"4"!=a&&0<e){for(var a=d.substring(d.lastIndexOf(".")+1).toLowerCase(),e=!1,g=LayerWin._k_editor._config.allowImageFileType,f=g.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,h=g.length,k=0;k<h;k++)if(a==g[k]){e=!0;break}if(1==e)if("base64"==LayerWin._k_editor._config.uploadMethod)if(c=G_dragDropFileObj[0],"1"==LayerWin._k_editor._config.useKManager)LayerWin.localImageToBase64({localPath:c.path,fn_callback:function(a){var b=
new Image;b.onload=function(){var c=b.width,d=b.height;b=void 0;a+="?"+c+"^"+d;event_keditor_detail_table_completed(a)};b.src=a}});else{var l=new FileReader;l.onload=function(){var a=l.result,b=new Image;b.onload=function(){a+="?"+b.width+"^"+b.height;event_keditor_detail_table_completed(a)};b.src=a;l=void 0};l.readAsDataURL(c)}else if("1"==LayerWin._k_editor._config.useKManager)event_keditor_detail_table_completed(LayerWin.convertImageAgentSrc("file:///"+d,!0));else if(loading_image_show(!0),"1"==
LayerWin._k_editor._config.uploadUseHTML5){a=new KEDITORTOP.RAONKEDITOR.util.hashTable;b=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);b+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+d.substring(d.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+
LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;b=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(b);a.setItem("k00",b);d=LayerWin.G_FormData.length;for(b=0;b<d;b++)e=LayerWin.G_FormData[b].form_value,e="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(e):
encodeURIComponent(e),a.setItem(LayerWin.G_FormData[b].form_name,e);uploadAjaxOnprogressStart({uploadType:"table_bg_image",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:c.name,fileObj:G_dragDropFileObj,formData:a},event_keditor_detail_table_completed)}else b.action=document.getElementById("upload_url").value,b.submit();else alert(f)}else""==d||"3"==a||"4"==a?(d=document.getElementById("image_url_value").value,"1"==LayerWin._k_editor._config.useKManager&&(d=LayerWin.convertImageAgentSrc(d,
!0)),event_keditor_detail_table_completed(d)):alert(LayerWin.RAONKEditor_lang.msg.alert_exec)}
function event_keditor_detail_table_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));var c=[];if(null!=a&&void 0!=a){try{var d={strUrl:a},b;b="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d);null!=b&&void 0!=b&&(a=b)}catch(e){}c=[];"0"!=LayerWin._k_editor._config.imageCustomPropertyDelimiter&&
(c=a.split(LayerWin._k_editor._config.imageCustomPropertyDelimiter),1<c.length&&(a=c[0]));b=a.split("?");2==b.length&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(d={strType:"imageUpload",strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,d)))return}catch(g){}a=
web_url_remove_char(a);d=document.getElementById("tab_value").value;b=document.getElementById("width_line").value;var f=document.getElementById("height_line").value,h=document.getElementById("width").value,k="px";document.getElementById("width_type")&&""!=document.getElementById("width_type").value&&(k=document.getElementById("width_type").value);var l=document.getElementById("height").value,m="";1==document.getElementById("table_edge_reduce").checked?m="Y":0==document.getElementById("table_edge_reduce").checked&&
(m="N");var p=document.getElementById("range").value,n=document.getElementById("topcell1"),q=document.getElementById("topcell2"),r=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var t={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};t.outsideTop=n.style.borderTop;t.outsideLeft=n.style.borderLeft;t.outsideRight=q?q.style.borderRight:n.style.borderRight;t.outsideBottom=r?r.style.borderBottom:n.style.borderBottom;r&&(t.insideRow=
r.style.borderTop);q&&(t.insideCol=n.style.borderRight);var n=document.getElementById("cell_gap").value,q=document.getElementById("cell_inside_margin").value,r=document.getElementById("table_caption").value,u=document.getElementById("table_summary").value,y=document.getElementById("add").value,v=document.getElementById("repeat").value,w=document.getElementById("horizontal").value,z=document.getElementById("vertical").value,x=document.getElementById("background_color").style.backgroundColor,B="N";
1==document.getElementById("scope").checked&&(B="Y");var D=document.getElementById("title_cell").value,C=document.getElementById("t_width_line").value,A=document.getElementById("t_height_line").value,J=document.getElementById("t_width").value,K=document.getElementById("t_height").value,G="N";1==document.getElementById("t_scope").checked&&(G="Y");var L=document.getElementById("templet").value,H=LayerWin.parseIntOr0(document.getElementById("margin_left").value),E=document.getElementById("class_name").value,
I=document.getElementById("table_id").value;"none"==document.getElementById("class_name").style.display&&(E=null);var F=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&(F=!0);var M=document.getElementById("custom_templet").value;LayerWin.event_keditor_detail_table_insert(d,b,f,h,l,m,p,t,n,q,r,u,a,y,v,w,z,x,B,D,C,A,J,K,G,L,H,window.frameElement.parentNode.parentNode,E,I,F,M,gXmlData,c,k)}
function keditor_table_property_upload_image(){var a=LayerWin._k_editor._config.accessibility,c=document.getElementById("table_caption").value,d=document.getElementById("table_summary").value,b="N";1==document.getElementById("scope").checked&&(b="Y");var e=document.getElementById("title_cell").value;if("1"==a)""==c&&alert(LayerWin.RAONKEditor_lang.msg.alert_table_caption_access1),""==d&&alert(LayerWin.RAONKEditor_lang.msg.alert_table_summary_access1),"1"!=e&&"N"==b&&alert(LayerWin.RAONKEditor_lang.msg.alert_scope_access1);
else if("2"==a){if(""==c){alert(LayerWin.RAONKEditor_lang.msg.alert_table_caption_access2);document.getElementById("table_caption").focus();return}if(""==d){alert(LayerWin.RAONKEditor_lang.msg.alert_table_summary_access2);document.getElementById("table_summary").focus();return}if("1"!=e&&"N"==b){alert(LayerWin.RAONKEditor_lang.msg.alert_scope_access2);document.getElementById("scope").focus();return}}d=document.keditor_upload_form;c=a="";if("1"==LayerWin._k_editor._config.useKManager)G_dragDropFileObj&&
G_dragDropFileObj[0]&&(c=G_dragDropFileObj[0].path);else if(a="1"==LayerWin._k_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id))c=a.value;if(0<c.lastIndexOf(".")){for(var b=c.substring(c.lastIndexOf(".")+1).toLowerCase(),e=!1,g=LayerWin._k_editor._config.allowImageFileType,f=g.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,h=g.length,k=0;k<h;k++)if(b==g[k]){e=!0;break}if(1==e)if("base64"==LayerWin._k_editor._config.uploadMethod)if(a=
G_dragDropFileObj[0],"1"==LayerWin._k_editor._config.useKManager)LayerWin.localImageToBase64({localPath:a.path,fn_callback:function(a){var b=new Image;b.onload=function(){var c=b.width,d=b.height;b=void 0;a+="?"+c+"^"+d;event_keditor_table_property_completed(a)};b.src=a}});else{var l=new FileReader;l.onload=function(){var a=l.result,b=new Image;b.onload=function(){a+="?"+b.width+"^"+b.height;event_keditor_table_property_completed(a)};b.src=a;l=void 0};l.readAsDataURL(a)}else if("1"==LayerWin._k_editor._config.useKManager)event_keditor_table_property_completed(LayerWin.convertImageAgentSrc("file:///"+
c,!0));else if(loading_image_show(!0),"1"==LayerWin._k_editor._config.uploadUseHTML5){d=new KEDITORTOP.RAONKEDITOR.util.hashTable;b=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);b+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+c.substring(c.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k15"+
KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;b=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(b);d.setItem("k00",b);c=LayerWin.G_FormData.length;for(b=0;b<c;b++)e=LayerWin.G_FormData[b].form_value,e="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?
KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(e):encodeURIComponent(e),d.setItem(LayerWin.G_FormData[b].form_name,e);uploadAjaxOnprogressStart({uploadType:"p_table_bg_image",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:a.name,fileObj:G_dragDropFileObj,formData:d},event_keditor_table_property_completed)}else d.action=document.getElementById("upload_url").value,d.submit();else alert(f)}else""==c?(c=document.getElementById("image_url_value").value,"1"==LayerWin._k_editor._config.useKManager&&
(c=LayerWin.convertImageAgentSrc(c,!0)),event_keditor_table_property_completed(c)):alert(LayerWin.RAONKEditor_lang.msg.alert_exec)}
function event_keditor_table_property_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));var c=[];if(_init_image_url!=a&&null!=a&&void 0!=a){try{var d={strUrl:a},b;b="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d);null!=b&&void 0!=b&&(a=b)}catch(e){}c=[];"0"!=
LayerWin._k_editor._config.imageCustomPropertyDelimiter&&(c=a.split(LayerWin._k_editor._config.imageCustomPropertyDelimiter),1<c.length&&(a=c[0]));b=a.split("?");2==b.length&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2]));"[FAIL]"!=a.substring(0,6)&&LayerWin.insertImageSrc(KEDITORTOP.G_CURRKEDITOR,a)}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(d={strType:"imageUpload",strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,
d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,d)))return}catch(g){}a=web_url_remove_char(a);d=document.getElementById("width").value;b="px";document.getElementById("width_type")&&""!=document.getElementById("width_type").value&&(b=document.getElementById("width_type").value);var f=document.getElementById("height").value,h="";1==document.getElementById("table_edge_reduce").checked?h="Y":0==document.getElementById("table_edge_reduce").checked&&(h="N");var k=document.getElementById("range").value,
l=LayerWin.parseIntOr0(document.getElementById("margin_left").value),m=document.getElementById("topcell1"),p=document.getElementById("topcell2"),n=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var q={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};q.outsideTop=m.style.borderTop;q.outsideLeft=m.style.borderLeft;q.outsideRight=p?p.style.borderRight:m.style.borderRight;q.outsideBottom=n?n.style.borderBottom:m.style.borderBottom;
n&&(q.insideRow=n.style.borderTop);p&&(q.insideCol=m.style.borderRight);var m=document.getElementById("cell_gap").value,p=document.getElementById("cell_inside_margin").value,n=document.getElementById("table_caption").value,r=document.getElementById("table_summary").value,t=document.getElementById("prev_background_remove").value,u=document.getElementById("add").value,y=document.getElementById("repeat").value,v=document.getElementById("horizontal").value,w=document.getElementById("vertical").value,
z=document.getElementById("background_color").style.backgroundColor,x="N";1==document.getElementById("scope").checked&&(x="Y");var B=document.getElementById("title_cell").value,D=document.getElementById("table_id").value,C=document.getElementById("class_name").value;"none"==document.getElementById("class_name").style.display&&(C=null);var A=!1;document.getElementById("input_cell_include")&&document.getElementById("input_cell_include").checked&&(A=!0);LayerWin.event_keditor_table_property(d,f,h,k,
q,m,p,n,r,t,a,u,y,v,w,z,x,B,l,window.frameElement.parentNode.parentNode,C,D,A,c,b)}
function keditor_cell_property_upload_image(){var a=LayerWin._k_editor._config.accessibility,c="";if("Y"==document.getElementById("title_cell").value||"N"==document.getElementById("title_cell").value)c=document.getElementById("title_cell").value;var d="";if("row"==document.getElementById("scope").value||"col"==document.getElementById("scope").value)d="row";if("1"==a)"Y"==c&&""==d&&alert(LayerWin.RAONKEditor_lang.msg.alert_scope_access1);else if("2"==a&&"Y"==c&&""==d){alert(LayerWin.RAONKEditor_lang.msg.alert_scope_access2);
document.getElementById("scope").focus();return}d=document.keditor_upload_form;c=a="";if("1"==LayerWin._k_editor._config.useKManager)G_dragDropFileObj&&G_dragDropFileObj[0]&&(c=G_dragDropFileObj[0].path);else if(a="1"==LayerWin._k_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id))c=a.value;if(0<c.lastIndexOf(".")){for(var b=c.substring(c.lastIndexOf(".")+1).toLowerCase(),e=!1,g=LayerWin._k_editor._config.allowImageFileType,f=g.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,
h=g.length,k=0;k<h;k++)if(b==g[k]){e=!0;break}if(1==e)if("base64"==LayerWin._k_editor._config.uploadMethod)if(a=G_dragDropFileObj[0],"1"==LayerWin._k_editor._config.useKManager)LayerWin.localImageToBase64({localPath:a.path,fn_callback:function(a){var b=new Image;b.onload=function(){var c=b.width,d=b.height;b=void 0;a+="?"+c+"^"+d;event_keditor_cell_property_completed(a)};b.src=a}});else{var l=new FileReader;l.onload=function(){var a=l.result,b=new Image;b.onload=function(){a+="?"+b.width+"^"+b.height;
event_keditor_cell_property_completed(a)};b.src=a;l=void 0};l.readAsDataURL(a)}else if("1"==LayerWin._k_editor._config.useKManager)event_keditor_cell_property_completed(LayerWin.convertImageAgentSrc("file:///"+c,!0));else if(loading_image_show(!0),"1"==LayerWin._k_editor._config.uploadUseHTML5){d=new KEDITORTOP.RAONKEDITOR.util.hashTable;b=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);b+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+
KEDITORTOP.RAONKSolution.Agent.vertical;b+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+c.substring(c.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;b=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(b);
d.setItem("k00",b);c=LayerWin.G_FormData.length;for(b=0;b<c;b++)e=LayerWin.G_FormData[b].form_value,e="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(e):encodeURIComponent(e),d.setItem(LayerWin.G_FormData[b].form_name,e);uploadAjaxOnprogressStart({uploadType:"cell_bg_image",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:a.name,fileObj:G_dragDropFileObj,formData:d},event_keditor_cell_property_completed)}else d.action=document.getElementById("upload_url").value,
d.submit();else alert(f)}else""==c?(c=document.getElementById("image_url_value").value,"1"==LayerWin._k_editor._config.useKManager&&(c=LayerWin.convertImageAgentSrc(c,!0)),event_keditor_cell_property_completed(c)):alert(LayerWin.RAONKEditor_lang.msg.alert_exec)}
function event_keditor_cell_property_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));var c=[];if(_init_image_url!=a){try{var d={strUrl:a},b;b="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d);null!=b&&void 0!=b&&(a=b)}catch(e){}null!=a&&void 0!=a&&(c=[],"0"!=
LayerWin._k_editor._config.imageCustomPropertyDelimiter&&(c=a.split(LayerWin._k_editor._config.imageCustomPropertyDelimiter),1<c.length&&(a=c[0])),b=a.split("?"),2==b.length&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2])),"[FAIL]"!=a.substring(0,6)&&LayerWin.insertImageSrc(KEDITORTOP.G_CURRKEDITOR,a))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(d={strType:"imageUpload",strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,
d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,d)))return}catch(g){}a=web_url_remove_char(a);d=document.getElementById("horizontal_align").value;b=document.getElementById("vertical_align").value;var f=document.getElementById("not_apply_class_name"),f=f?f.checked:!1,h=document.getElementById("not_apply_cell_id").checked,k="",k=document.getElementById("title_cell").value,l="",l=document.getElementById("scope").value,m="",m=document.getElementById("nowrap").value,p=document.getElementById("topcell1"),
n=document.getElementById("topcell2"),q=document.getElementById("bottomcell1");document.getElementById("bottomcell2");var r={outsideTop:"",outsideLeft:"",outsideRight:"",outsideBottom:"",insideRow:"",insideCol:""};r.outsideTop=p.style.borderTop;r.outsideLeft=p.style.borderLeft;r.outsideRight=n?n.style.borderRight:p.style.borderRight;r.outsideBottom=q?q.style.borderBottom:p.style.borderBottom;q&&(r.insideRow=q.style.borderTop);n&&(r.insideCol=p.style.borderRight);var p=document.getElementById("prev_background_remove").value,
n=document.getElementById("add").value,q=document.getElementById("repeat").value,t=document.getElementById("horizontal").value,u=document.getElementById("vertical").value,y=document.getElementById("background_color").style.backgroundColor;document.getElementById("tab_value");var v=document.getElementById("class_name").value,w=document.getElementById("cell_id").value;"notapplicable"==n&&(n=null);"notapplicable"==q&&(q=null);"notapplicable"==d&&(d=null);"notapplicable"==b&&(b=null);if("none"==document.getElementById("class_name").style.display||
"notapplicable"==v||f)v=null;"notapplicable"==k&&(k=null);"notapplicable"==l&&(l=null);"notapplicable"==m&&(m=null);h&&(w=null);var h=f="",z=document.getElementById("cell_width"),x=document.getElementById("cell_height");z&&x&&(z=z.value,x=x.value,""!=z&&G_preWidth!=z&&(f=z),""!=x&&G_preHeight!=x&&(h=x));LayerWin.event_keditor_cell_property(d,b,k,l,m,r,p,a,n,q,t,u,y,window.frameElement.parentNode.parentNode,v,w,c,f,h)}
function keditor_dog_bg_img_upload_image(){var a=document.keditor_upload_form,c="",d="";if("1"==LayerWin._k_editor._config.useKManager)G_dragDropFileObj&&G_dragDropFileObj[0]&&(d=G_dragDropFileObj[0].path);else if(c="1"==LayerWin._k_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id))d=c.value;if(0<d.lastIndexOf(".")){for(var b=d.substring(d.lastIndexOf(".")+1).toLowerCase(),e=!1,g=LayerWin._k_editor._config.allowImageFileType,f=g.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,
h=g.length,k=0;k<h;k++)if(b==g[k]){e=!0;break}if(1==e)if("base64"==LayerWin._k_editor._config.uploadMethod)if(c=G_dragDropFileObj[0],"1"==LayerWin._k_editor._config.useKManager)LayerWin.localImageToBase64({localPath:c.path,fn_callback:function(a){var b=new Image;b.onload=function(){var c=b.width,d=b.height;b=void 0;a+="?"+c+"^"+d;event_keditor_dog_bg_img_completed(a)};b.src=a}});else{var l=new FileReader;l.onload=function(){var a=l.result,b=new Image;b.onload=function(){a+="?"+b.width+"^"+b.height;
event_keditor_dog_bg_img_completed(a)};b.src=a;l=void 0};l.readAsDataURL(c)}else if("1"==LayerWin._k_editor._config.useKManager)event_keditor_dog_bg_img_completed(LayerWin.convertImageAgentSrc("file:///"+d,!0));else if(loading_image_show(!0),"1"==LayerWin._k_editor._config.uploadUseHTML5){a=new KEDITORTOP.RAONKEDITOR.util.hashTable;b=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);b+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+
KEDITORTOP.RAONKSolution.Agent.vertical;b+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+d.substring(d.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;b=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(b);
a.setItem("k00",b);d=LayerWin.G_FormData.length;for(b=0;b<d;b++)e=LayerWin.G_FormData[b].form_value,e="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(e):encodeURIComponent(e),a.setItem(LayerWin.G_FormData[b].form_name,e);uploadAjaxOnprogressStart({uploadType:"doc_bg_image",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:c.name,fileObj:G_dragDropFileObj,formData:a},event_keditor_dog_bg_img_completed)}else a.action=document.getElementById("upload_url").value,
a.submit();else alert(f)}else""==d?(d=document.getElementById("image_url_value").value,"1"==LayerWin._k_editor._config.useKManager&&(d=LayerWin.convertImageAgentSrc(d,!0)),event_keditor_dog_bg_img_completed(d)):alert(LayerWin.RAONKEditor_lang.msg.alert_exec)}
function keditor_upload_video_media(){var a=document.keditor_upload_form,c="",d="";"1"==LayerWin._k_editor._config.useKManager?G_dragDropFileObj&&G_dragDropFileObj[0]&&(d=G_dragDropFileObj[0].path):(c="1"==LayerWin._k_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),d=c.value);""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?(G_dragDropFileObjLen=G_dragDropFileObj.length,c={value:G_dragDropFileObj[0].name,
id:document.getElementById(file_field_id).id,name:document.getElementById(file_field_id).name}):c={value:""}:c=document.getElementById(file_field_id);var b=document.getElementById("web_url");if(document.getElementsByName("InputFlag")[0].checked)if(0<d.lastIndexOf(".")){for(var b=d.substring(d.lastIndexOf(".")+1).toLowerCase(),e=!1,g=LayerWin._k_editor._config.allowVideoFileType,f=g.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,h=g.length,k=0;k<h;k++)if(b==g[k]){e=!0;break}if(1==e)if(loading_image_show(!0),
"1"==LayerWin._k_editor._config.useKManager)a=new KEDITORTOP.RAONKEDITOR.util.hashTable,c=function(a){event_keditor_video_upload_completed(a[0].path)},a=[],d={guid:"cid:"+KEDITORTOP.RAONKEDITOR.util.makeGuid(),path:d,callback:c},a.push(d),LayerWin.agentFileUpload(LayerWin._k_editor,a,c);else if("1"==LayerWin._k_editor._config.uploadUseHTML5){a=new KEDITORTOP.RAONKEDITOR.util.hashTable;b=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);b+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+
KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+d.substring(d.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;
b=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(b);a.setItem("k00",b);d=LayerWin.G_FormData.length;for(b=0;b<d;b++)e=LayerWin.G_FormData[b].form_value,e="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(e):encodeURIComponent(e),a.setItem(LayerWin.G_FormData[b].form_name,e);uploadAjaxOnprogressStart({uploadType:"video",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:c.name,fileObj:G_dragDropFileObj,formData:a},event_keditor_video_upload_completed)}else a.action=
document.getElementById("upload_url").value,a.submit();else alert(f)}else""==d?alert(LayerWin.RAONKEditor_lang.msg.alert_no_file):alert(LayerWin.RAONKEditor_lang.msg.alert_exec);else d=b.value,c=(new RegExp(/^(http|ftp|https|news)/)).test(d),a=/^\s\s*$/,""==d||a.exec(d)||c&&!KEDITORTOP.RAONKEDITOR.util.checkUrl(d)?(alert(LayerWin.RAONKEditor_lang.msg.alert_url),b.focus()):event_keditor_video_upload_completed(d)}
function event_keditor_video_upload_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));if(document.getElementsByName("InputFlag")[0].checked){if(null!=a&&void 0!=a){try{var c={strUrl:a},d;d="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,c):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,c);null!=d&&void 0!=d&&
(a=d)}catch(b){}d=a.split("?");2==d.length&&-1<d[1].indexOf("^")&&(a=d[0],d=d[1].split("^"),3==d.length&&(a+="?"+d[2]))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(c={strType:"mediaUpload",strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,c):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,c)))return}catch(e){}if("[FAIL]"==a.substring(0,6)){confirm(LayerWin.RAONKEditor_lang.msg.uploadFailed)&&
alert(a);return}if(elemModify){"0"==LayerWin._k_editor._config.useReplaceImage?null!=elemModify.getAttribute("src")?(elemData.src=a,elemData.source=[]):0<elemModify.getElementsByTagName("source").length&&(elemData.source=[],elemData.source.push({src:a}),elemData.src=""):""!=elemData.src?(elemData.src=a,elemData.source=[]):0<elemData.source.length&&(elemData.source=[],elemData.source.push({src:a}),elemData.src="");"function"==typeof G_UploadCompleteCallBackFn&&(G_UploadCompleteCallBackFn(),LayerWin.hideDialog(window.frameElement.parentNode.parentNode));
return}}c=document.getElementById("media_width").value;d=document.getElementById("media_height").value;var g=document.getElementById("media_width_unit"),f=document.getElementById("media_height_unit"),g=0==LayerWin.parseIntOr0(c)?"":c+g.value,f=0==LayerWin.parseIntOr0(d)?"":d+f.value;LayerWin.insertElementsSrc(KEDITORTOP.G_CURRKEDITOR,a);f={type:"video_media",src:a,width:g,height:f,autoPlay:document.getElementById("cb_autostart").checked,loop:document.getElementById("cb_loop").checked,controls:document.getElementById("cb_controls").checked,
muted:document.getElementById("cb_muted").checked};c=""+("<video style='width:"+c+"; height:"+d+";'");1==f.autoPlay&&(c+=" autoplay=''");1==f.loop&&(c+=" loop=''");1==f.controls&&(c+=" controls=''");1==f.muted&&(c+=" muted=''");c=c+">"+("<source src='"+f.src.slice(0,f.src.lastIndexOf("."))+".mp4' type='video/mp4' />");c+="<source src='"+f.src.slice(0,f.src.lastIndexOf("."))+".ogv' type='video/ogg' />";c+="<source src='"+f.src.slice(0,f.src.lastIndexOf("."))+".webm' type='video/webm' />";c+="HTML5 Video\ub97c \uc9c0\uc6d0\ud558\uc9c0 \uc54a\ub294 \ube0c\ub77c\uc6b0\uc800";
c+="</video>";LayerWin.event_keditor_media_upload("","","0",a,c,f,window.frameElement.parentNode.parentNode)}function event_keditor_cell_border_completed(){var a=document.getElementById("edge_border").style.borderTop,c=document.getElementById("edge_border").style.borderLeft,d=document.getElementById("edge_border").style.borderRight,b=document.getElementById("edge_border").style.borderBottom;LayerWin.event_keditor_cell_border(a,c,d,b,window.frameElement.parentNode.parentNode)}
function event_keditor_dog_bg_img_completed(a){null!=a&&void 0!=a&&(a=a.replace(/\r\n/g,""),a=a.replace(/\n/g,""),a=a.replace(/\t/g,""));var c=[];if(_init_image_url!=a){try{var d={strUrl:a},b;b="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d);null!=b&&void 0!=b&&(a=b)}catch(e){}null!=a&&void 0!=a&&(c=[],"0"!=
LayerWin._k_editor._config.imageCustomPropertyDelimiter&&(c=a.split(LayerWin._k_editor._config.imageCustomPropertyDelimiter),1<c.length&&(a=c[0])),b=a.split("?"),2==b.length&&(a=b[0],b=b[1].split("^"),3==b.length&&(a+="?"+b[2])),"[FAIL]"!=a.substring(0,6)&&LayerWin.insertImageSrc(KEDITORTOP.G_CURRKEDITOR,a))}loading_image_show(!1);if("[FAIL]"==a.substring(0,6))try{if(d={strType:"imageUpload",strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,
d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,d)))return}catch(g){}a=web_url_remove_char(a);d=document.getElementById("prev_background_remove").value;b=document.getElementById("add").value;var f=document.getElementById("repeat").value,h=document.getElementById("background_color").style.backgroundColor;LayerWin.event_keditor_dog_bg_img_insert(d,a,b,f,h,window.frameElement.parentNode.parentNode,c)}
function event_keditor_find_completed(){var a=document.getElementById("search_contents").value,c=document.getElementsByName("search_option")[0].checked,d=document.getElementsByName("search_option")[1].checked,b=document.getElementsByName("search_option")[2].checked,e;1==document.getElementsByName("search_direction")[0].checked?e=!1:1==document.getElementsByName("search_direction")[1].checked&&(e=!0);LayerWin.event_keditor_find(a,c,d,b,e,window.frameElement.parentNode.parentNode)}
function event_keditor_replace_completed(){var a=document.getElementById("search_contents").value,c=document.getElementById("replace_contents").value,d=document.getElementsByName("search_option")[0].checked,b=document.getElementsByName("search_option")[1].checked,e=document.getElementsByName("search_option")[2].checked,g;1==document.getElementsByName("search_direction")[0].checked?g=!1:1==document.getElementsByName("search_direction")[1].checked&&(g=!0);LayerWin.event_keditor_replace(a,c,d,b,e,g,
window.frameElement.parentNode.parentNode)}
function event_keditor_all_replace_completed(){var a=document.getElementById("search_contents").value,c=document.getElementById("replace_contents").value,d=document.getElementsByName("search_option")[0].checked,b=document.getElementsByName("search_option")[1].checked,e=document.getElementsByName("search_option")[2].checked,g;1==document.getElementsByName("search_direction")[0].checked?g=!1:1==document.getElementsByName("search_direction")[1].checked&&(g=!0);LayerWin.event_keditor_all_replace(a,c,
d,b,e,g,window.frameElement.parentNode.parentNode)}function event_keditor_spellcheck_find_completed(a){LayerWin.event_keditor_spellcheck_find(a)}function event_keditor_spellcheck_replace_completed(){var a=document.getElementById("wrong_word").value,c=document.getElementById("replace_word").value;LayerWin.event_keditor_spellcheck_replace(a,c)}
function event_keditor_spellcheck_all_replace_completed(){var a=document.getElementById("wrong_word").value,c=document.getElementById("replace_word").value;LayerWin.event_keditor_spellcheck_all_replace(a,c)}
function event_keditor_capital_small_letter_completed(){1==document.getElementsByName("capital_small_letter")[0].checked?_capital_small_letter="LOWER":1==document.getElementsByName("capital_small_letter")[1].checked?_capital_small_letter="UPPER":1==document.getElementsByName("capital_small_letter")[2].checked&&(_capital_small_letter="FIRSTUPPER");LayerWin.event_keditor_capital_small_letter(_capital_small_letter,window.frameElement.parentNode.parentNode)}
function event_keditor_emoticon_completed(a,c,d,b){LayerWin.event_keditor_emoticon_insert({srcURL:a,width:"",height:"",title:c,alt:c,margin_left:"",margin_right:"",margin_top:"",margin_bottom:"",align_obj:"",align:"",border:"0",linkurl:"",borderStyle:"",borderKind:"",borderColor:"",borderThickness:""},window.frameElement.parentNode.parentNode)}
function event_keditor_insert_row_column_completed(){var a="",c="";1==document.getElementById("row").checked?(a="R",1==document.getElementById("up").checked?c="U":1==document.getElementById("down").checked&&(c="D")):1==document.getElementById("column").checked&&(a="C",1==document.getElementById("right").checked?c="R":1==document.getElementById("left").checked&&(c="L"));var d=document.getElementById("line_count").value;LayerWin.event_keditor_insert_row_column(a,c,d,window.frameElement.parentNode.parentNode)}
function event_keditor_row_property_completed(){var a=document.getElementById("background_color").style.backgroundColor,c=document.getElementById("row_height").value,d=document.getElementById("horizontal_align").value,b=document.getElementById("vertical_align").value;LayerWin.event_keditor_row_property(a,c,d,b,window.frameElement.parentNode.parentNode)}
function event_keditor_column_property_completed(){var a=document.getElementById("background_color").style.backgroundColor,c=document.getElementById("column_width").value,d=document.getElementById("horizontal_align").value,b=document.getElementById("vertical_align").value;LayerWin.event_keditor_column_property(a,c,d,b,window.frameElement.parentNode.parentNode)}
function keditor_create_iframe(){var a=document.getElementById("input_url").value,c=(new RegExp(/^(http|ftp|https|news)/)).test(a),d=/^\s\s*$/;if(""==a||d.exec(a)||c&&!KEDITORTOP.RAONKEDITOR.util.checkUrl(a))alert(LayerWin.RAONKEditor_lang.msg.alert_url),setCursorPos(document.getElementById("input_url"),!0,!1);else{a=LayerWin._k_editor._config.accessibility;c=document.getElementById("input_title").value;if("1"==a)""==c&&alert(LayerWin.RAONKEditor_lang.msg.alert_iframe_input_title_access1);else if("2"==
a&&""==c){alert(LayerWin.RAONKEditor_lang.msg.alert_iframe_input_title_access2);document.getElementById("input_title").focus();return}a=document.getElementById("input_width").value;d=document.getElementById("input_width_unit");c=document.getElementById("input_height_unit");d=0==LayerWin.parseIntOr0(a)?"":a+d.value;a=document.getElementById("input_height").value;a=0==LayerWin.parseIntOr0(a)?"":a+c.value;a={type:"iframe",src:document.getElementById("input_url").value,id:document.getElementById("input_id").value,
name:document.getElementById("input_name").value,className:document.getElementById("input_class").value,title:document.getElementById("input_title").value,width:d,height:a,align:document.getElementById("select_align").value,scrolling:document.getElementById("select_scroll").value,frameBorder:document.getElementById("input_border").checked};c=LayerWin.getLinkMediaType(a.src);0<c.length&&(a.type=c,a.type2="iframe");LayerWin.event_keditor_create_iframe(a,window.frameElement.parentNode.parentNode)}}
function keditor_create_hyperlink_image(){var a=document.keditor_upload_form,c="",d="";"1"==LayerWin._k_editor._config.useKManager?G_dragDropFileObj&&G_dragDropFileObj[0]&&(d=G_dragDropFileObj[0].path):(c="1"==LayerWin._k_editor._config.uploadUseHTML5?document.getElementById("file_text"):document.getElementById(file_field_id),d=c.value);if(""==d)alert(LayerWin.RAONKEditor_lang.background_image.msg_file_select),setCursorPos(c,!0,!1);else if(0<d.lastIndexOf(".")){for(var b=d.substring(d.lastIndexOf(".")+
1).toLowerCase(),e=!1,g=LayerWin._k_editor._config.allowImageFileType,f=g.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,h=g.length,k=0;k<h;k++)if(b==g[k]){e=!0;break}if(e)if(loading_image_show(!0),"1"==LayerWin._k_editor._config.useKManager)c=function(a){keditor_create_hyperlink(a[0].path)},a=[],d={guid:"cid:"+KEDITORTOP.RAONKEDITOR.util.makeGuid(),path:d,callback:c},a.push(d),LayerWin.agentFileUpload(LayerWin._k_editor,a,c);else if("1"==LayerWin._k_editor._config.uploadUseHTML5){a=new KEDITORTOP.RAONKEDITOR.util.hashTable;
b=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);b+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+d.substring(d.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;b+=
"k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;b=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(b);a.setItem("k00",b);d=LayerWin.G_FormData.length;for(b=0;b<d;b++)e=LayerWin.G_FormData[b].form_value,e="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(e):encodeURIComponent(e),a.setItem(LayerWin.G_FormData[b].form_name,
e);uploadAjaxOnprogressStart({uploadType:"hyperlink_image",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:c.name,fileObj:G_dragDropFileObj,formData:a},keditor_create_hyperlink)}else a.action=document.getElementById("upload_url").value,a.submit();else alert(f),setCursorPos(c,!0,!1)}else alert(f),setCursorPos(c,!0,!1)}
function keditor_create_hyperlink(a){if("hyperlink"==document.getElementById("select_category").value||0>"bookmark,image".indexOf(document.getElementById("select_category").value)){var c=document.getElementById("input_url").value,d=(new RegExp(/^(http|https|ftp|news)/)).test(c),b=/^\s\s*$/;if(""==c||b.exec(c)||d&&!KEDITORTOP.RAONKEDITOR.util.checkUrl(c)){alert(LayerWin.RAONKEditor_lang.msg.alert_url);setCursorPos(document.getElementById("input_url"),!0,!1);return}}else if("bookmark"==document.getElementById("select_category").value&&
""==document.getElementById("select_bookmark").value){alert(LayerWin.RAONKEditor_lang.msg.alert_bookmark);setCursorPos(document.getElementById("select_bookmark"),!0,!1);return}c=LayerWin._k_editor._config.accessibility;d=document.getElementById("input_text").value;if("1"==c)""==d&&alert(LayerWin.RAONKEditor_lang.msg.alert_hyperlink_input_text_access1);else if("2"==c&&""==d){alert(LayerWin.RAONKEditor_lang.msg.alert_hyperlink_input_text_access2);document.getElementById("input_text").focus();return}c=
document.getElementById("select_category").value;0>"bookmark,image".indexOf(document.getElementById("select_category").value)&&(c="hyperlink");c={type:c,url:document.getElementById("input_url").value,text:document.getElementById("input_text").value,title:document.getElementById("input_title").value,target:document.getElementById("select_target").value,bookname:document.getElementById("select_bookmark").value,id:document.getElementById("input_id").value,className:document.getElementById("input_class").value};
if(null!=a&&void 0!=a){a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");try{var d={strUrl:a},e;e="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,d);null!=e&&void 0!=e&&(a=e)}catch(g){}if("[FAIL]"==a.substring(0,6))try{if(d={strType:"imageUpload",strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?
KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,d):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,d)))return}catch(f){}e=a.split("?");2==e.length&&(a=e[0],e=e[1].split("^"),3==e.length&&(img_real_width=e[0],img_real_height=e[1],a+="?"+e[2]));a&&"[FAIL]"!=a.substring(0,6)&&LayerWin.insertImageSrc(KEDITORTOP.G_CURRKEDITOR,a);if(elemModify){document.getElementById("input_url").value=a;set_modify_ok();return}c.url=a}LayerWin.event_keditor_create_hyperlink(c,
window.frameElement.parentNode.parentNode)}function split_cell_ok(){var a=document.getElementById("input_row"),c=document.getElementById("input_column"),d=document.getElementsByName("radio_split")[0],b=document.getElementsByName("radio_split")[1];d.checked?c.value="0":b.checked&&(a.value="0");LayerWin.event_keditor_split_cell(a.value,c.value,window.frameElement.parentNode.parentNode)}
function symbol_ok(){var a=document.getElementById("input_output");LayerWin.event_keditor_symbol(a.innerHTML,window.frameElement.parentNode.parentNode)}
function template_ok(){var a=document.getElementById("clicked_template").value,c=document.getElementById("template_print_header").value,d=document.getElementById("template_print_footer").value,a={url:a,print_header:c,print_footer:d};0==KEDITORTOP.RAONKEDITOR.isEmpty()?1==confirm(LayerWin.RAONKEditor_lang.msg.newDocument)&&LayerWin.event_keditor_template(a,window.frameElement.parentNode.parentNode):LayerWin.event_keditor_template(a,window.frameElement.parentNode.parentNode)}
function keditor_insert_link_media(){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin.RAONKEditor_lang.insert_link_media.tag_null);else{var a="",c=document.getElementById("ta_media_tag").value,d=document.getElementById("ta_media_caption").value,b=!1;document.getElementById("check_allow_full_screen")&&(b=document.getElementById("check_allow_full_screen").checked);var c=c.replace(/\r\n/g,""),c=c.replace(/\n/g,""),c=c.replace(/\r/g,""),a=c.match(/(<[\s]*embed [^>]+>)/gi),e=c.match(/(<[\s]*iframe [^>]+>)/gi),
c=c.match(/(<[\s]*object [^>]+>)/gi),g=LayerWin._k_editor._config.xss_remove_tags.toLowerCase();if(c&&-1<g.indexOf("object"))alert(LayerWin.RAONKEditor_lang.msg.alert_insert_link_media_xss);else{if(a){if(-1<g.indexOf("embed")){alert(LayerWin.RAONKEditor_lang.msg.alert_insert_link_media_xss);return}a=a[0]}else if(e){if(-1<g.indexOf("iframe")){alert(LayerWin.RAONKEditor_lang.msg.alert_insert_link_media_xss);return}a=e[0]}else{alert(LayerWin.RAONKEditor_lang.insert_link_media.invalid_tag);return}if("1"==
LayerWin._k_editor._config.allowLinkMediaCaption)if("1"==LayerWin._k_editor._config.accessibility)""==d&&alert(LayerWin.RAONKEditor_lang.msg.alert_insert_link_media_caption_access1);else if("2"==LayerWin._k_editor._config.accessibility&&""==d){alert(LayerWin.RAONKEditor_lang.msg.alert_insert_link_media_caption_access2);document.getElementById("ta_media_caption").focus();return}LayerWin.event_keditor_insert_link_media(a,d,b,window.frameElement.parentNode.parentNode)}}}
function keditor_modify_link_media(a){if(""==document.getElementById("ta_media_tag").value)alert(LayerWin.RAONKEditor_lang.insert_link_media.tag_null);else{var c="",d=document.getElementById("ta_media_tag").value,b=document.getElementById("ta_media_caption").value,e=!1;document.getElementById("check_allow_full_screen")&&(e=document.getElementById("check_allow_full_screen").checked);d=d.replace(/\r\n/g,"");d=d.replace(/\n/g,"");d=d.replace(/\r/g,"");c=d.match(/(<[\s]*embed [^>]+>)/gi);d=d.match(/(<[\s]*iframe [^>]+>)/gi);
if(c)c=c[0];else if(d)c=d[0];else{alert(LayerWin.RAONKEditor_lang.insert_link_media.invalid_tag);return}LayerWin.event_keditor_modify_link_media(c,b,e,a,window.frameElement.parentNode.parentNode)}}function keditor_insert_paste_dialog_html(){var a=document.getElementById("pasteArea").contentWindow.document.body.innerHTML;LayerWin.event_keditor_insert_paste_dialog_html(a,window.frameElement.parentNode.parentNode)}
function keditor_insert_input_text(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertReadonly:!1,insertType:"text",insertSize:"",insertMaxlength:"",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth="0"==document.getElementById("input_width").value?"":document.getElementById("input_width").value;a.insertHeight="0"==document.getElementById("input_height").value?"":document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertReadonly=document.getElementById("input_readonly").checked;a.insertSize="0"==
document.getElementById("input_size").value?"":document.getElementById("input_size").value;a.insertMaxlength="0"==document.getElementById("input_maxtext").value?"":document.getElementById("input_maxtext").value;for(var c=document.getElementsByName("input_type"),d=c.length,b=0;b<d;b++)if(1==c[b].checked){a.insertType=c[b].value;break}for(var c=document.getElementById("event_table"),d=c.childNodes.length,b=0;b<d;b++){var e=c.childNodes[b].getElementsByTagName("span");a.insertEventNameArr.push(e[0].innerHTML);
a.insertEventFunctionArr.push(e[1].innerHTML)}LayerWin.event_keditor_insert_input_text(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_text(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=
!0);elemModify.getAttribute("size")&&""!=elemModify.getAttribute("size")&&(document.getElementById("input_size").value=elemModify.getAttribute("size"));elemModify.getAttribute("maxlength")&&""!=elemModify.getAttribute("maxlength")&&(document.getElementById("input_maxtext").value=elemModify.getAttribute("maxlength"));"text"==elemModify.type?(document.getElementById("input_type_general").checked=!0,document.getElementById("input_type_password").checked=!1):"password"==elemModify.type&&(document.getElementById("input_type_general").checked=
!1,document.getElementById("input_type_password").checked=!0);if(elemModify.getAttribute("keditorcustomdata")){var a=LayerWin.getKEditorCustomData(elemModify.getAttribute("keditorcustomdata"));if("event"==a.type){var c=a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),d=a.length;for(i=0;i<d;i++){var b=document.getElementById("event_table"),e=document.createElement("tr"),g=document.createElement("td");g.className="type2";var f=document.createElement("a"),h=document.createElement("span");
h.appendChild(document.createTextNode(a[i]));f.appendChild(h);f.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var k=document.createElement("a"),l=document.createElement("span");l.appendChild(document.createTextNode(c[i]));k.appendChild(l);k.title=c[i];g.appendChild(f);e.appendChild(g);h.appendChild(k);e.appendChild(h);b.appendChild(e)}}}}
function keditor_modify_input_text(){0<LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount&&LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?(elemModify.setAttribute("value",document.getElementById("input_value").value),elemModify.value=document.getElementById("input_value").value):(elemModify.setAttribute("value",""),elemModify.value="");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:
elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";""!=document.getElementById("input_width").value&&
"0"!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value&&"0"!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.readOnly=document.getElementById("input_readonly").checked;""!=document.getElementById("input_size").value&&
"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size");""!=document.getElementById("input_maxtext").value&&"0"!=document.getElementById("input_maxtext").value?elemModify.maxLength=document.getElementById("input_maxtext").value:elemModify.removeAttribute("maxLength");for(var a=document.getElementsByName("input_type"),c=a.length,d=0;d<c;d++)if(1==a[d].checked){try{elemModify.type=a[d].value}catch(b){d='<input type="'+
a[d].value+'" />',a=LayerWin._iframeDoc.createElement("div"),a.innerHTML=d,newElem=a.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT=newElem,elemModify=null,elemModify=newElem}break}""!=document.getElementById("input_name").value?KEDITORTOP.RAONKEDITOR.browser.ie&&8<=KEDITORTOP.RAONKEDITOR.browser.ieVersion||!KEDITORTOP.RAONKEDITOR.browser.ie?elemModify.setAttribute("name",
document.getElementById("input_name").value):(d=elemModify.outerHTML,d=d.replace('name="'+elemModify.name+'"',""),d=d.replace("name='"+elemModify.name+"'",""),d=d.replace("name="+elemModify.name,""),d=d.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=d):elemModify.removeAttribute("name");var e=document.getElementById("event_table"),g=e.childNodes.length;if(0<g){for(var c=a="",d=0;d<g;d++)0!=d&&(a+="\x0B",c+="\x0B"),a+=e.childNodes[d].getElementsByTagName("span")[0].innerHTML,
c+=e.childNodes[d].getElementsByTagName("span")[1].innerHTML;""!=a&&(d={type:"event"},d.eventName=a,d.eventFunction=c,LayerWin.setKEditorCustomData(elemModify,d))}else elemModify.removeAttribute("keditorcustomdata");LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount=0;event_popup_close()}
function keditor_insert_input_radio_or_checkbox(a){var c={insertType:"",insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertChecked:!1,insertEventNameArr:[],insertEventFunctionArr:[]};c.insertType=a;c.insertName=document.getElementById("input_name").value;c.insertValue=document.getElementById("input_value").value;c.insertId=document.getElementById("input_id").value;c.insertClass=document.getElementById("input_class").value;
c.insertTitle=document.getElementById("input_title").value;c.insertWidth=document.getElementById("input_width").value;c.insertHeight=document.getElementById("input_height").value;c.insertDisabled=document.getElementById("input_disabled").checked;var d=document.getElementsByName("input_status"),b=d.length;for(a=0;a<b;a++)if(1==d[a].checked){c.insertChecked="true"==d[a].value?!0:!1;break}d=document.getElementById("event_table");b=d.childNodes.length;for(a=0;a<b;a++){var e=d.childNodes[a].getElementsByTagName("span");
c.insertEventNameArr.push(e[0].innerHTML);c.insertEventFunctionArr.push(e[1].innerHTML)}LayerWin.event_keditor_insert_input_radio_or_checkbox(c,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_radio_or_checkbox(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.checked?document.getElementById("input_checked").checked=!0:document.getElementById("input_not_checked").checked=!0;if(elemModify.getAttribute("keditorcustomdata")){var a=
LayerWin.getKEditorCustomData(elemModify.getAttribute("keditorcustomdata"));if("event"==a.type){var c=a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),d=a.length;for(i=0;i<d;i++){var b=document.getElementById("event_table"),e=document.createElement("tr"),g=document.createElement("td");g.className="type2";var f=document.createElement("a"),h=document.createElement("span");h.innerHTML=a[i];f.appendChild(h);f.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";
var k=document.createElement("a"),l=document.createElement("span");l.innerHTML=c[i];k.appendChild(l);k.title=c[i];g.appendChild(f);e.appendChild(g);h.appendChild(k);e.appendChild(h);b.appendChild(e)}}}}
function keditor_modify_input_radio_or_checkbox(a){0<LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount&&LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?
elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+
"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;var c=document.getElementsByName("input_status"),d=c.length;for(a=0;a<d;a++)if(1==c[a].checked){"true"==c[a].value?(elemModify.checked=!0,elemModify.setAttribute("checked","checked")):(elemModify.checked=!1,elemModify.removeAttribute("checked"));break}""!=document.getElementById("input_name").value?KEDITORTOP.RAONKEDITOR.browser.ie&&8<=KEDITORTOP.RAONKEDITOR.browser.ieVersion||!KEDITORTOP.RAONKEDITOR.browser.ie?
elemModify.setAttribute("name",document.getElementById("input_name").value):(a=elemModify.outerHTML,a=a.replace('name="'+elemModify.name+'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=a):elemModify.removeAttribute("name");var b=document.getElementById("event_table"),e=b.childNodes.length;if(0<e){d=c="";for(a=0;a<e;a++)0!=a&&(c+="\x0B",d+="\x0B"),c+=b.childNodes[a].getElementsByTagName("span")[0].innerHTML,
d+=b.childNodes[a].getElementsByTagName("span")[1].innerHTML;""!=c&&(a={type:"event"},a.eventName=c,a.eventFunction=d,LayerWin.setKEditorCustomData(elemModify,a))}else elemModify.removeAttribute("keditorcustomdata");LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount=0;event_popup_close()}
function keditor_insert_input_button(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertType:"button",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;
a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;for(var c=document.getElementsByName("input_type"),d=c.length,b=0;b<d;b++)if(1==c[b].checked){a.insertType=c[b].value;break}for(var c=document.getElementById("event_table"),d=c.childNodes.length,b=0;b<d;b++){var e=c.childNodes[b].getElementsByTagName("span");
a.insertEventNameArr.push(e[0].innerHTML);a.insertEventFunctionArr.push(e[1].innerHTML)}LayerWin.event_keditor_insert_input_button(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_button(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=
!0);"button"==elemModify.type?(document.getElementById("input_general").checked=!0,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=!1):"reset"==elemModify.type?(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!0,document.getElementById("input_submit").checked=!1):"submit"==elemModify.type&&(document.getElementById("input_general").checked=!1,document.getElementById("input_reset").checked=!1,document.getElementById("input_submit").checked=
!0);if(elemModify.getAttribute("keditorcustomdata")){var a=LayerWin.getKEditorCustomData(elemModify.getAttribute("keditorcustomdata"));if("event"==a.type){var c=a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),d=a.length;for(i=0;i<d;i++){var b=document.getElementById("event_table"),e=document.createElement("tr"),g=document.createElement("td");g.className="type2";var f=document.createElement("a"),h=document.createElement("span");h.innerHTML=a[i];f.appendChild(h);f.title=a[i];h=document.createElement("td");
h.className="type2";h.style.width="65%";var k=document.createElement("a"),l=document.createElement("span");l.innerHTML=c[i];k.appendChild(l);k.title=c[i];g.appendChild(f);e.appendChild(g);h.appendChild(k);e.appendChild(h);b.appendChild(e)}}}}
function keditor_modify_input_button(){0<LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount&&LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=
document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+
"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;for(var a=document.getElementsByName("input_type"),c=a.length,d=0;d<c;d++)if(1==a[d].checked){try{elemModify.type=a[d].value}catch(b){d='<input type="'+a[d].value+'" />',a=LayerWin._iframeDoc.createElement("div"),a.innerHTML=d,newElem=a.firstChild,LayerWin.setCopyAllObjectAtributesForInput(elemModify,newElem,!1),elemModify.parentNode.replaceChild(newElem,elemModify),LayerWin.KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT=
newElem,elemModify=null,elemModify=newElem}break}""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_name").value?KEDITORTOP.RAONKEDITOR.browser.ie&&8<=KEDITORTOP.RAONKEDITOR.browser.ieVersion||!KEDITORTOP.RAONKEDITOR.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(d=elemModify.outerHTML,d=d.replace('name="'+elemModify.name+
'"',""),d=d.replace("name='"+elemModify.name+"'",""),d=d.replace("name="+elemModify.name,""),d=d.replace(">",'name="'+document.getElementById("input_name").value+'" />'),elemModify.outerHTML=d):elemModify.removeAttribute("name");var e=document.getElementById("event_table"),g=e.childNodes.length;if(0<g){for(var c=a="",d=0;d<g;d++)0!=d&&(a+="\x0B",c+="\x0B"),a+=e.childNodes[d].getElementsByTagName("span")[0].innerHTML,c+=e.childNodes[d].getElementsByTagName("span")[1].innerHTML;""!=a&&(d={type:"event"},
d.eventName=a,d.eventFunction=c,LayerWin.setKEditorCustomData(elemModify,d))}else elemModify.removeAttribute("keditorcustomdata");LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount=0;event_popup_close()}
function setInputSelectPageEvent(){var a=document.getElementById("input_value"),c=document.getElementById("btn_add"),d=document.getElementById("btn_modify"),b=document.getElementById("btn_delete"),e=document.getElementById("btn_up"),g=document.getElementById("btn_down");d.disabled=!0;d.className="non_btn";b.disabled=!0;b.className="non_btn";e.disabled=!0;e.className="non_btn";g.disabled=!0;g.className="non_btn";var f=document.getElementById("option_table");KEDITORTOP.RAONKEDITOR.util.addEvent(c,"click",
btn_select_add_click);KEDITORTOP.RAONKEDITOR.util.addEvent(d,"click",btn_select_mod_click);KEDITORTOP.RAONKEDITOR.util.addEvent(b,"click",btn_select_del_click);KEDITORTOP.RAONKEDITOR.util.addEvent(e,"click",btn_select_up_click);KEDITORTOP.RAONKEDITOR.util.addEvent(g,"click",btn_select_down_click);KEDITORTOP.RAONKEDITOR.util.addEvent(f,"click",function(a){a=a||window.event;var c=a.target?a.target:a.srcElement;a=document.getElementById("input_option");var h=document.getElementById("input_option_value");
if(c=KEditorLayerWin.GetParentbyTagName(c,"tr"))_clicked_options=c,c.style.background="#e5e5e5",a.value=c.getElementsByTagName("span")[0].innerHTML,h.value=c.getElementsByTagName("span")[1].innerHTML;for(a=0;a<f.childNodes.length;a++)f.childNodes[a]!=_clicked_options&&(f.childNodes[a].style.background="white");d.disabled=!1;d.className="in_btn";b.disabled=!1;b.className="in_btn";e.disabled=!1;e.className="in_btn";g.disabled=!1;g.className="in_btn"});var h=document.getElementById("input_multiselect");
LayerWin.KEDITORTOP.RAONKEDITOR.util.addEvent(h,"click",function(){if(0==h.checked)for(var b=f.getElementsByTagName("input"),c=b.length,d=!1,e=0;e<c;e++)b[e].checked&&(d?b[e].checked=!1:(a.value=f.childNodes[e].getElementsByTagName("span")[1].innerHTML,d=!0))})}
function btn_select_add_click(){var a=document.getElementById("input_option"),c=document.getElementById("input_option_value");document.getElementById("btn_add");if(""!=a.value){var d=document.getElementById("option_table"),b=document.getElementById("input_value"),e=document.createElement("tr"),g=document.createElement("td");g.className="type";var f=document.createElement("input");f.type="checkbox";var h=document.createElement("td");h.className="type2";h.style.width="44%";var k=document.createElement("a"),
l=document.createElement("span");l.innerHTML=a.value;k.appendChild(l);k.title=a.value;l=document.createElement("td");l.className="type2";l.style.width="44%";var m=document.createElement("a"),p=document.createElement("span");p.innerHTML=c.value;m.appendChild(p);m.title=c.value;g.appendChild(f);e.appendChild(g);h.appendChild(k);e.appendChild(h);l.appendChild(m);e.appendChild(l);d.appendChild(e);a.value="";c.value="";LayerWin.KEDITORTOP.RAONKEDITOR.util.addEvent(f,"click",function(){if(0==document.getElementById("input_multiselect").checked)if(1==
f.checked)for(var a=d.getElementsByTagName("input"),c=a.length,e=0;e<c;e++)a[e]!=f?a[e].checked=!1:b.value=p.innerHTML;else b.value="";else if(1==f.checked)b.value=p.innerHTML;else for(a=d.getElementsByTagName("input"),c=a.length,b.value="",e=0;e<c;e++)if(a[e].checked){b.value=d.childNodes[e].getElementsByTagName("span")[1].innerHTML;break}})}}
function btn_select_mod_click(){if(_clicked_options){var a=document.getElementById("input_option"),c=document.getElementById("input_option_value");_clicked_options.getElementsByTagName("span")[0].innerHTML=a.value;_clicked_options.getElementsByTagName("span")[1].innerHTML=c.value}}
function btn_select_del_click(){document.getElementById("option_table");document.getElementById("btn_add");var a=document.getElementById("btn_modify"),c=document.getElementById("btn_delete"),d=document.getElementById("btn_up"),b=document.getElementById("btn_down");document.getElementById("input_option").value="";document.getElementById("input_option_value").value="";_clicked_options&&_clicked_options.parentNode.removeChild(_clicked_options);a.disabled=!0;a.className="non_btn";c.disabled=!0;c.className=
"non_btn";d.disabled=!0;d.className="non_btn";b.disabled=!0;b.className="non_btn"}function btn_select_up_click(){_clicked_options&&_clicked_options.previousSibling&&_clicked_options.parentNode.insertBefore(_clicked_options,_clicked_options.previousSibling)}function btn_select_down_click(){_clicked_options&&_clicked_options.nextSibling&&_clicked_options.parentNode.insertBefore(_clicked_options.nextSibling,_clicked_options)}
function setInputCommonEventPageEvent(){var a=document.getElementById("btn_event_add"),c=document.getElementById("btn_event_modify"),d=document.getElementById("btn_event_delete");c.disabled=!0;c.className="non_btn";d.disabled=!0;d.className="non_btn";var b=document.getElementById("event_table");KEDITORTOP.RAONKEDITOR.util.addEvent(a,"click",btn_common_event_add_click);KEDITORTOP.RAONKEDITOR.util.addEvent(c,"click",btn_common_event_mod_click);KEDITORTOP.RAONKEDITOR.util.addEvent(d,"click",btn_common_event_del_click);
KEDITORTOP.RAONKEDITOR.util.addEvent(b,"click",function(a){a=a||window.event;var g=a.target?a.target:a.srcElement;a=document.getElementById("input_event_name");var f=document.getElementById("input_event_function");if(g=KEditorLayerWin.GetParentbyTagName(g,"tr"))_clicked_event=g,g.style.background="#e5e5e5",a.value=g.getElementsByTagName("span")[0].innerHTML,f.value=g.getElementsByTagName("span")[1].innerHTML;for(a=0;a<b.childNodes.length;a++)b.childNodes[a]!=_clicked_event&&(b.childNodes[a].style.background=
"white");c.disabled=!1;c.className="in_btn";d.disabled=!1;d.className="in_btn"})}
function btn_common_event_add_click(){var a=document.getElementById("input_event_name"),c=document.getElementById("input_event_function");document.getElementById("btn_event_add");if(""!=a.value){var d=document.getElementById("event_table"),b=d.childNodes.length;if(0<b)for(var e=0;e<b;e++)if(a.value==d.childNodes[e].getElementsByTagName("span")[0].innerHTML){alert(a.value+" "+LayerWin.RAONKEditor_lang.input_common.event_duplicate_msg);return}d=document.getElementById("event_table");b=document.createElement("tr");
e=document.createElement("td");e.className="type2";var g=document.createElement("a"),f=document.createElement("span");f.innerHTML=a.value;g.appendChild(f);g.title=a.value;a=document.createElement("td");a.className="type2";a.style.width="65%";var f=document.createElement("a"),h=document.createElement("span");h.innerHTML=c.value;f.appendChild(h);f.title=c.value;e.appendChild(g);b.appendChild(e);a.appendChild(f);b.appendChild(a);d.appendChild(b);c.value=""}}
function btn_common_event_mod_click(){if(_clicked_event){var a=document.getElementById("input_event_name"),c=document.getElementById("input_event_function"),d=document.getElementById("event_table"),b=d.childNodes.length;if(0<b)for(var e=0;e<b;e++)if("white"==d.childNodes[e].style.background&&a.value==d.childNodes[e].getElementsByTagName("span")[0].innerHTML){alert(a.value+" "+LayerWin.RAONKEditor_lang.input_common.event_duplicate_msg);return}_clicked_event.getElementsByTagName("span")[0].innerHTML=
a.value;_clicked_event.getElementsByTagName("span")[1].innerHTML=c.value}}function btn_common_event_del_click(){document.getElementById("event_table");document.getElementById("btn_event_add");var a=document.getElementById("btn_event_modify"),c=document.getElementById("btn_event_delete");document.getElementById("input_event_function").value="";_clicked_event&&_clicked_event.parentNode.removeChild(_clicked_event);a.disabled=!0;a.className="non_btn";c.disabled=!0;c.className="non_btn"}
function keditor_insert_input_select(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertSize:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertMultiselect:!1,insertOptionsArr:[],insertOptionsValueArr:[],insertOptionsSelected:[],insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=
document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;a.insertSize="0"==document.getElementById("input_size").value?"":document.getElementById("input_size").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertMultiselect=document.getElementById("input_multiselect").checked;for(var c=document.getElementById("option_table"),
d=c.childNodes.length,b=0;b<d;b++){var e=c.childNodes[b].getElementsByTagName("span"),g=c.childNodes[b].getElementsByTagName("input")[0];a.insertOptionsArr.push(e[0].innerHTML);a.insertOptionsValueArr.push(e[1].innerHTML);a.insertOptionsSelected.push(g.checked)}c=document.getElementById("event_table");d=c.childNodes.length;for(b=0;b<d;b++)e=c.childNodes[b].getElementsByTagName("span"),a.insertEventNameArr.push(e[0].innerHTML),a.insertEventFunctionArr.push(e[1].innerHTML);LayerWin.event_keditor_insert_input_select(a,
window.frameElement.parentNode.parentNode)}
function set_modify_field_input_select(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.size&&(document.getElementById("input_size").value=elemModify.size);""!=elemModify.style.width&&(document.getElementById("input_width").value=parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.multiple&&(document.getElementById("input_multiselect").checked=!0);for(var a=elemModify.getElementsByTagName("option"),
c=a.length,d=0;d<c;d++){var b=a[d].innerHTML,e=a[d].value;document.getElementById("btn_add");var g=document.getElementById("option_table"),f=document.getElementById("input_value"),h=document.createElement("tr"),k=document.createElement("td");k.className="type";var l=document.createElement("input");l.type="checkbox";var m=document.createElement("td");m.className="type2";m.style.width="44%";var p=document.createElement("a"),n=document.createElement("span");n.innerHTML=b;p.appendChild(n);p.title=b;n=
document.createElement("td");n.className="type2";n.style.width="44%";var b=document.createElement("a"),q=document.createElement("span");q.innerHTML=e;b.appendChild(q);b.title=e;k.appendChild(l);h.appendChild(k);m.appendChild(p);h.appendChild(m);n.appendChild(b);h.appendChild(n);g.appendChild(h);LayerWin.KEDITORTOP.RAONKEDITOR.util.addEvent(l,"click",function(){if(0==document.getElementById("input_multiselect").checked)if(1==l.checked)for(var a=g.getElementsByTagName("input"),b=a.length,c=0;c<b;c++)a[c]!=
l?a[c].checked=!1:f.value=q.innerHTML;else f.value="";else if(1==l.checked)f.value=q.innerHTML;else for(a=g.getElementsByTagName("input"),b=a.length,f.value="",c=0;c<b;c++)if(a[c].checked){f.value=g.childNodes[c].getElementsByTagName("span")[1].innerHTML;break}});a[d].selected&&(l.checked=!0)}if(elemModify.getAttribute("keditorcustomdata")&&(h=LayerWin.getKEditorCustomData(elemModify.getAttribute("keditorcustomdata")),"event"==h.type))for(d=h.eventFunction,a=h.eventName.split("\x0B"),c=d.split("\x0B"),
e=a.length,d=0;d<e;d++)g=document.getElementById("event_table"),h=document.createElement("tr"),k=document.createElement("td"),k.className="type2",b=document.createElement("a"),m=document.createElement("span"),m.innerHTML=a[d],b.appendChild(m),b.title=a[d],m=document.createElement("td"),m.className="type2",m.style.width="65%",p=document.createElement("a"),n=document.createElement("span"),n.innerHTML=c[d],p.appendChild(n),p.title=c[d],k.appendChild(b),h.appendChild(k),m.appendChild(p),h.appendChild(m),
g.appendChild(h)}
function keditor_modify_input_select(){0<LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount&&LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?elemModify.className=
document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_size").value&&"0"!=document.getElementById("input_size").value?elemModify.size=document.getElementById("input_size").value:elemModify.removeAttribute("size");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+
"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.multiple=document.getElementById("input_multiselect").checked;elemModify.innerHTML="";for(var a=document.getElementById("option_table"),c=a.childNodes.length,d=0;d<c;d++){var b=document.createElement("option");b.innerHTML=a.childNodes[d].getElementsByTagName("span")[0].innerHTML;
b.setAttribute("value",a.childNodes[d].getElementsByTagName("span")[1].innerHTML);b.selected=a.childNodes[d].getElementsByTagName("input")[0].checked;elemModify.appendChild(b)}""!=document.getElementById("input_name").value?KEDITORTOP.RAONKEDITOR.browser.ie&&8<=KEDITORTOP.RAONKEDITOR.browser.ieVersion||!KEDITORTOP.RAONKEDITOR.browser.ie?elemModify.setAttribute("name",document.getElementById("input_name").value):(d=elemModify.outerHTML,d=d.replace('name="'+elemModify.name+'"',""),d=d.replace("name='"+
elemModify.name+"'",""),d=d.replace("name="+elemModify.name,""),d=d.replace(">",' name="'+document.getElementById("input_name").value+'" >'),elemModify.outerHTML=d):elemModify.removeAttribute("name");var b=document.getElementById("event_table"),e=b.childNodes.length;if(0<e){c=a="";for(d=0;d<e;d++)0!=d&&(a+="\x0B",c+="\x0B"),a+=b.childNodes[d].getElementsByTagName("span")[0].innerHTML,c+=b.childNodes[d].getElementsByTagName("span")[1].innerHTML;""!=a&&(d={type:"event"},d.eventName=a,d.eventFunction=
c,LayerWin.setKEditorCustomData(elemModify,d))}else elemModify.removeAttribute("keditorcustomdata");LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount=0;event_popup_close()}
function keditor_insert_input_textarea(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:"",insertWidth:"",insertHeight:"",insertAlign:"",insertDisabled:!1,insertReadonly:!1,insertRows:"",insertCols:"",insertWrap:"",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;
a.insertTitle=document.getElementById("input_title").value;a.insertWidth=document.getElementById("input_width").value;a.insertHeight=document.getElementById("input_height").value;a.insertAlign=document.getElementById("input_textalign").value;a.insertDisabled=document.getElementById("input_disabled").checked;a.insertReadonly=document.getElementById("input_readonly").checked;a.insertRows="0"==document.getElementById("input_rows").value?"":document.getElementById("input_rows").value;a.insertCols="0"==
document.getElementById("input_cols").value?"":document.getElementById("input_cols").value;for(var c=document.getElementById("event_table"),d=c.childNodes.length,b=0;b<d;b++){var e=c.childNodes[b].getElementsByTagName("span");a.insertEventNameArr.push(e[0].innerHTML);a.insertEventFunctionArr.push(e[1].innerHTML)}LayerWin.event_keditor_insert_input_textarea(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_textarea(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);""!=elemModify.value&&(document.getElementById("input_value").value=elemModify.value);""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=elemModify.title);""!=elemModify.style.width&&(document.getElementById("input_width").value=
parseInt(elemModify.style.width,10));""!=elemModify.style.height&&(document.getElementById("input_height").value=parseInt(elemModify.style.height,10));""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.style.textAlign);elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);elemModify.readOnly&&(document.getElementById("input_readonly").checked=!0);""!=elemModify.rows&&(document.getElementById("input_rows").value=elemModify.rows);""!=elemModify.cols&&
(document.getElementById("input_cols").value=elemModify.cols);if(elemModify.getAttribute("keditorcustomdata")){var a=LayerWin.getKEditorCustomData(elemModify.getAttribute("keditorcustomdata"));if("event"==a.type){var c=a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),d=a.length;for(i=0;i<d;i++){var b=document.getElementById("event_table"),e=document.createElement("tr"),g=document.createElement("td");g.className="type2";var f=document.createElement("a"),h=document.createElement("span");
h.innerHTML=a[i];f.appendChild(h);f.title=a[i];h=document.createElement("td");h.className="type2";h.style.width="65%";var k=document.createElement("a"),l=document.createElement("span");l.innerHTML=c[i];k.appendChild(l);k.title=c[i];g.appendChild(f);e.appendChild(g);h.appendChild(k);e.appendChild(h);b.appendChild(e)}}}}
function keditor_modify_input_textarea(){0<LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount&&LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();""!=document.getElementById("input_value").value?(elemModify.value=document.getElementById("input_value").value,elemModify.innerHTML=document.getElementById("input_value").value):(elemModify.value="",elemModify.innerHTML="");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");
""!=document.getElementById("input_class").value?elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=
document.getElementById("input_height").value+"px":elemModify.style.height="";""!=document.getElementById("input_textalign").value?elemModify.style.textAlign=document.getElementById("input_textalign").value:elemModify.style.textAlign="";elemModify.disabled=document.getElementById("input_disabled").checked;elemModify.readOnly=document.getElementById("input_readonly").checked;""!=document.getElementById("input_rows").value&&"0"!=document.getElementById("input_rows").value?elemModify.rows=document.getElementById("input_rows").value:
elemModify.removeAttribute("rows");""!=document.getElementById("input_cols").value&&"0"!=document.getElementById("input_cols").value?elemModify.cols=document.getElementById("input_cols").value:elemModify.removeAttribute("cols");if(""!=document.getElementById("input_name").value)if(KEDITORTOP.RAONKEDITOR.browser.ie&&8<=KEDITORTOP.RAONKEDITOR.browser.ieVersion||!KEDITORTOP.RAONKEDITOR.browser.ie)elemModify.setAttribute("name",document.getElementById("input_name").value);else{var a=elemModify.outerHTML,
a=a.replace('name="'+elemModify.name+'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",' name="'+document.getElementById("input_name").value+'" >');elemModify.outerHTML=a}else elemModify.removeAttribute("name");var c=document.getElementById("event_table"),d=c.childNodes.length;if(0<d){for(var b=a="",e=0;e<d;e++)0!=e&&(a+="\x0B",b+="\x0B"),a+=c.childNodes[e].getElementsByTagName("span")[0].innerHTML,b+=c.childNodes[e].getElementsByTagName("span")[1].innerHTML;
""!=a&&(c={type:"event"},c.eventName=a,c.eventFunction=b,LayerWin.setKEditorCustomData(elemModify,c))}else elemModify.removeAttribute("keditorcustomdata");LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount=0;event_popup_close()}
function keditor_insert_input_hidden(){var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;LayerWin.event_keditor_insert_input_hidden(a,window.frameElement.parentNode.parentNode)}
function set_modify_field_input_hidden(){var a=elemModify.getAttribute("keditorcustomdata");null!=a&&void 0!=a&&(a=LayerWin.getKEditorCustomData(a),""!=a.id&&(document.getElementById("input_id").value=a.id),""!=a.name&&(document.getElementById("input_name").value=a.name),""!=a.value&&(document.getElementById("input_value").value=a.value),""!=a.className&&(document.getElementById("input_class").value=a.className),""!=a.title&&(document.getElementById("input_title").value=a.title))}
function keditor_modify_input_hidden(){0<LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount&&LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();var a={insertName:"",insertValue:"",insertId:"",insertClass:"",insertTitle:""};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;
LayerWin.event_keditor_insert_input_hidden(a,window.frameElement.parentNode.parentNode)}
function keditor_insert_input_image(){var a=document.keditor_upload_form,c;c=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id);var d=document.getElementById("img_web_url"),b="";document.getElementsByName("InputFlag")[0].checked?"1"==LayerWin._k_editor._config.useKManager?G_dragDropFileObj&&G_dragDropFileObj[0]&&(b=G_dragDropFileObj[0].path):
b=c.value:b=d.value;if(0<b.lastIndexOf(".")){for(var d=b.substring(b.lastIndexOf(".")+1).toLowerCase(),e=!1,g=LayerWin._k_editor._config.allowImageFileType,f=g.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,h=g.length,k=0;k<h;k++)if(d==g[k]){e=!0;break}if(1==e)if("base64"==LayerWin._k_editor._config.uploadMethod)if(c=G_dragDropFileObj[0],"1"==LayerWin._k_editor._config.useKManager)LayerWin.localImageToBase64({localPath:c.path,fn_callback:function(a){var b=new Image;b.onload=function(){var c=
b.width,d=b.height;b=void 0;a+="?"+c+"^"+d;event_keditor_input_image_upload_completed(a)};b.src=a}});else{var l=new FileReader;l.onload=function(){var a=l.result,b=new Image;b.onload=function(){a+="?"+b.width+"^"+b.height;event_keditor_input_image_upload_completed(a)};b.src=a;l=void 0};l.readAsDataURL(c)}else if(document.getElementsByName("InputFlag")[0].checked)if("1"==LayerWin._k_editor._config.useKManager)b=LayerWin.convertImageAgentSrc("file:///"+b,!0),event_keditor_input_image_upload_completed(b);
else if(loading_image_show(!0),"1"==LayerWin._k_editor._config.uploadUseHTML5){a=new KEDITORTOP.RAONKEDITOR.util.hashTable;d=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);d+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical;d+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+b.substring(b.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;d+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+
LayerWin._k_editor._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical;d+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;d+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;d=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(d);a.setItem("k00",d);b=LayerWin.G_FormData.length;for(d=0;d<b;d++)e=LayerWin.G_FormData[d].form_value,e="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(e):
encodeURIComponent(e),a.setItem(LayerWin.G_FormData[d].form_name,e);uploadAjaxOnprogressStart({uploadType:"image",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:c.id,fileObj:G_dragDropFileObj,formData:a},event_keditor_input_image_upload_completed)}else a.action=document.getElementById("upload_url").value,a.submit();else event_keditor_input_image_upload_completed(b);else alert(f)}else alert(LayerWin.RAONKEditor_lang.msg.alert_exec)}
function event_keditor_input_image_upload_completed(a){var c=document.getElementById("input_width").value,d=document.getElementById("input_height").value,b=0,e=0;if(null!=a&&void 0!=a){a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");if((a=a.replace(/\t/g,""))&&""!=a)try{var g={strUrl:a},f;f="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,g):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,
g);null!=f&&void 0!=f&&(a=f)}catch(h){}g=a.split("?");2==g.length&&(a=g[0],g=g[1].split("^"),2==g.length?(b=g[0],e=g[1]):3==g.length&&(b=g[0],e=g[1],a+="?"+g[2]));if(elemModify&&"input"==elemModify.tagName.toLowerCase()&&"image"==elemModify.type){elemModify.src=a;"function"==typeof G_UploadCompleteCallBackFn&&G_UploadCompleteCallBackFn();return}"1"==LayerWin._k_editor._config.image_auto_fit&&b>LayerWin._k_editor._defaultWidth?(g=LayerWin._k_editor._defaultWidth/b,b=LayerWin._k_editor._defaultWidth,
e*=g):"2"==LayerWin._k_editor._config.image_auto_fit&&(b>LayerWin._k_editor._defaultWidth||e>LayerWin._k_editor._defaultHeight)&&(c=LayerWin._k_editor._defaultWidth,d=LayerWin._k_editor._defaultHeight,g=d/c,f=e/b,f>g?e>d?c=Math.round(b*d/e):(c=b,d=e):f<g?b>c?d=Math.round(e*c/b):(c=b,d=e):(c=b,d=e))}0==c.length&&0<b&&(c=parseInt(b),d=parseInt(e));loading_image_show(!1);if((4>a.length||"http"!=a.substring(0,4).toLowerCase())&&"base64"!=LayerWin._k_editor._config.uploadMethod)confirm(LayerWin.RAONKEditor_lang.msg.uploadFailed)&&
alert(a);else{a=web_url_remove_char(a);a={insertName:"",insertValue:"",insertSrc:a,insertId:"",insertClass:"",insertTitle:"",insertAlign:"",insertWidth:"",insertHeight:"",insertDisabled:!1,insertType:"image",insertEventNameArr:[],insertEventFunctionArr:[]};a.insertName=document.getElementById("input_name").value;a.insertValue=document.getElementById("input_value").value;a.insertId=document.getElementById("input_id").value;a.insertClass=document.getElementById("input_class").value;a.insertTitle=document.getElementById("input_title").value;
a.insertAlign=document.getElementById("input_textalign").value;a.insertWidth=c;a.insertHeight=d;a.insertDisabled=document.getElementById("input_disabled").checked;b=document.getElementById("event_table");e=b.childNodes.length;for(c=0;c<e;c++)d=b.childNodes[c].getElementsByTagName("span"),a.insertEventNameArr.push(d[0].innerHTML),a.insertEventFunctionArr.push(d[1].innerHTML);LayerWin.event_keditor_insert_input_image(a,window.frameElement.parentNode.parentNode)}}
function set_modify_field_input_image(){""!=elemModify.name&&(document.getElementById("input_name").value=elemModify.name);elemModify.getAttribute("value")&&""!=elemModify.getAttribute("value")&&(document.getElementById("input_value").value=elemModify.getAttribute("value"));""!=elemModify.id&&(document.getElementById("input_id").value=elemModify.id);""!=elemModify.className&&(document.getElementById("input_class").value=elemModify.className);""!=elemModify.title&&(document.getElementById("input_title").value=
elemModify.title);""!=elemModify.style.textAlign&&(document.getElementById("input_textalign").value=elemModify.align);document.getElementById("input_width").value=""!=elemModify.style.width?parseInt(elemModify.style.width,10):"";document.getElementById("input_height").value=""!=elemModify.style.height?parseInt(elemModify.style.height,10):"";elemModify.disabled&&(document.getElementById("input_disabled").checked=!0);var a=elemModify.outerHTML.match(RegExp("srcs*=s*(\"|')(([^\"']*))(\"|')","gi")),c=
"";a&&0<a.length&&(c=a[0].replace("src=",""),c=c.replace(/\'/g,""),c=c.replace(/\"/g,""),c=c.replace(/\&amp;/g,"&"));"1"==KEditorLayerWin._k_editor._config.useKManager&&(c=decodeURIComponent(c),c=LayerWin.convertImageAgentSrc(c,!1),c=decodeURIComponent(c));document.getElementById("img_web_url").value=c;var d=document.getElementById("img_ratio"),b=document.getElementById("input_width"),e=document.getElementById("input_height"),g,f;g=b.value;f=e.value;d.style.display="block";KEDITORTOP.RAONKEDITOR.util.addEvent(b,
"keyup",function(){if("true"==d.getAttribute("ratio-checked")){var a=parseInt(f,10)*parseInt(b.value,10)/parseInt(g,10);e.value=isNaN(a)?e.value:Math.round(a)}});KEDITORTOP.RAONKEDITOR.util.addEvent(e,"keyup",function(){if("true"==d.getAttribute("ratio-checked")){var a=parseInt(g,10)*parseInt(e.value,10)/parseInt(f,10);b.value=isNaN(a)?b.value:Math.round(a)}});if(elemModify.getAttribute("keditorcustomdata")&&(a=LayerWin.getKEditorCustomData(elemModify.getAttribute("keditorcustomdata")),"event"==a.type)){var c=
a.eventFunction,a=a.eventName.split("\x0B"),c=c.split("\x0B"),h=a.length;for(i=0;i<h;i++){var k=document.getElementById("event_table"),l=document.createElement("tr"),m=document.createElement("td");m.className="type2";var p=document.createElement("a"),n=document.createElement("span");n.innerHTML=a[i];p.appendChild(n);p.title=a[i];n=document.createElement("td");n.className="type2";n.style.width="65%";var q=document.createElement("a"),r=document.createElement("span");r.innerHTML=c[i];q.appendChild(r);
q.title=c[i];m.appendChild(p);l.appendChild(m);n.appendChild(q);l.appendChild(n);k.appendChild(l)}}if("1"==KEditorLayerWin._k_editor._config.uploadUseHTML5||"1"==KEditorLayerWin._k_editor._config.useKManager)a=document.getElementById("radio_image_url"),document.getElementById("radio_image").removeAttribute("checked"),a.setAttribute("checked","checked"),InputFlag_change(a)}
function keditor_modify_input_image(){0<LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount&&LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();var a=function(){""!=document.getElementById("input_value").value?elemModify.setAttribute("value",document.getElementById("input_value").value):elemModify.removeAttribute("value");""!=document.getElementById("input_id").value?elemModify.id=document.getElementById("input_id").value:elemModify.removeAttribute("id");""!=document.getElementById("input_class").value?
elemModify.className=document.getElementById("input_class").value:elemModify.removeAttribute("class");""!=document.getElementById("input_title").value?elemModify.title=document.getElementById("input_title").value:elemModify.removeAttribute("title");""!=document.getElementById("input_textalign").value?elemModify.align=document.getElementById("input_textalign").value:elemModify.removeAttribute("align");""!=document.getElementById("input_width").value?elemModify.style.width=document.getElementById("input_width").value+
"px":elemModify.style.width="";""!=document.getElementById("input_height").value?elemModify.style.height=document.getElementById("input_height").value+"px":elemModify.style.height="";elemModify.disabled=document.getElementById("input_disabled").checked;if(""!=document.getElementById("input_name").value)if(KEDITORTOP.RAONKEDITOR.browser.ie&&8<=KEDITORTOP.RAONKEDITOR.browser.ieVersion||!KEDITORTOP.RAONKEDITOR.browser.ie)elemModify.setAttribute("name",document.getElementById("input_name").value);else{var a=
elemModify.outerHTML,a=a.replace('name="'+elemModify.name+'"',""),a=a.replace("name='"+elemModify.name+"'",""),a=a.replace("name="+elemModify.name,""),a=a.replace(">",'name="'+document.getElementById("input_name").value+'" />');elemModify.outerHTML=a}else elemModify.removeAttribute("name");var b=document.getElementById("event_table"),c=b.childNodes.length;if(0<c){for(var g=a="",f=0;f<c;f++)0!=f&&(a+="\x0B",g+="\x0B"),a+=b.childNodes[f].getElementsByTagName("span")[0].innerHTML,g+=b.childNodes[f].getElementsByTagName("span")[1].innerHTML;
""!=a&&(b={type:"event"},b.eventName=a,b.eventFunction=g,LayerWin.setKEditorCustomData(elemModify,b))}else elemModify.removeAttribute("keditorcustomdata");LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.putUndo();LayerWin.KEDITORTOP.G_CURRKEDITOR.UndoManager.charCount=0;G_UploadCompleteCallBackFn=void 0;event_popup_close()},c=document.getElementById(file_field_id);c.value&&""!=c.value||("1"==KEditorLayerWin._k_editor._config.uploadUseHTML5||"1"==KEditorLayerWin._k_editor._config.useKManager)&&G_dragDropFileObj?
(G_UploadCompleteCallBackFn=a,keditor_insert_input_image()):(c=document.getElementById("img_web_url"),elemModify.src=LayerWin.convertImageAgentSrc(c.value,!0),a())}function event_keditor_horizontal_line_cancel(){LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}
function event_keditor_image_upload_cancel(){"1"==LayerWin._k_editor._config.uploadUseHTML5&&"function"==typeof uploadAjaxOnprogressCancel&&uploadAjaxOnprogressCancel();LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}function event_keditor_bg_image_upload_cancel(){LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}function event_keditor_flash_upload_cancel(){clearWindow(window);LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}
function event_keditor_media_upload_cancel(){LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}function event_keditor_table_cancel(){LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}function event_keditor_doc_cancel(){LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}function event_keditor_emoticon_cancel(){LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}
function event_keditor_about_close(){LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}function event_popup_close(a){LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}function event_keditor_insert_datetime_close(){LayerWin.event_dialog_cancel(window.frameElement.parentNode.parentNode)}function event_keditor_insert_datetime(a){LayerWin.command_insert_datetime(KEDITORTOP.G_CURRKEDITOR.ID,KEDITORTOP.G_CURRKEDITOR,a)}
function clearWindow(a){a.document.open("text/html","replace");isCustomDomain()&&(a.document.domain=LayerWin.document.domain);a.document.write("<html><head></head><body></body></html>");a.document.close()}function isCustomDomain(){if(!KEDITORTOP.RAONKEDITOR.browser.ie)return!1;var a=LayerWin.document.domain,c=window.location.hostname;return a!=c&&a!="["+c+"]"}
function setCursorPos(a,c,d){null!=a&&void 0!=a&&null==navigator.userAgent.match(/iPhone|iPad/)&&setTimeout(function(){var b=0;a.value&&(b=a.value.length);try{if(0!=b&&0!=c)if("setSelectionRange"in a)d?a.setSelectionRange(0,b):a.setSelectionRange(b,b);else if("createTextRange"in a){var e=a.createTextRange();d||e.moveStart("character",b);e.select()}a.focus()}catch(g){}},0)}
function event_tab(a,c){9==("which"in a?a.which:a.keyCode)&&"last"==(a.target?a.target:a.srcElement).getAttribute("last_cursor_obj")&&(setCursorPos(c,!0,!1),KEDITORTOP.RAONKEDITOR.util.cancelEvent(a))}
function edgeClick(a,c){LayerWin._k_editor.applyEdgeMode="user";edgeSelectClick(4,"user");var d=document.getElementById("topcell1"),b=document.getElementById("topcell2"),e=document.getElementById("bottomcell1"),g=document.getElementById("bottomcell2");document.getElementById("edge_top");document.getElementById("edge_horizon");document.getElementById("edge_bottom");document.getElementById("edge_left");document.getElementById("edge_vertical");document.getElementById("edge_right");var f=document.getElementById("edge_"+
a).src.split("/");if(f[f.length-1]=="editor_line_"+a+"_d_img.gif")document.getElementById("edge_"+a).src="../images/editor/dialog/editor_line_"+a+"_img.gif",f="",f=""==document.getElementById("line_kind").value?f+(document.getElementById("line_thickness").value+"px"):f+document.getElementById("line_kind").value,f+=" "+document.getElementById("line_style").style.borderTopStyle,f+=" "+document.getElementById("line_color").style.borderTopColor,"top"==a?(d&&(d.style.borderTop=f,cellRemoveClass(d,"ke_cell_border_t")),
b&&(b.style.borderTop=f,cellRemoveClass(b,"ke_cell_border_t"))):"horizon"==a?(e&&(d.style.borderBottom=f,e.style.borderTop=f,cellRemoveClass(d,"ke_cell_border_b"),cellRemoveClass(e,"ke_cell_border_t")),g&&(b.style.borderBottom=f,g.style.borderTop=f,cellRemoveClass(b,"ke_cell_border_b"),cellRemoveClass(g,"ke_cell_border_t"))):"bottom"==a?e?(e.style.borderBottom=f,cellRemoveClass(e,"ke_cell_border_b"),g&&(g.style.borderBottom=f,cellRemoveClass(g,"ke_cell_border_b"))):(d&&(d.style.borderBottom=f,cellRemoveClass(d,
"ke_cell_border_b")),b&&(b.style.borderBottom=f,cellRemoveClass(b,"ke_cell_border_b"))):"left"==a?(d&&(d.style.borderLeft=f,cellRemoveClass(d,"ke_cell_border_l")),e&&(e.style.borderLeft=f,cellRemoveClass(e,"ke_cell_border_l"))):"vertical"==a?(b&&(d.style.borderRight=f,b.style.borderLeft=f,cellRemoveClass(d,"ke_cell_border_r"),cellRemoveClass(b,"ke_cell_border_l")),g&&(e.style.borderRight=f,g.style.borderLeft=f,cellRemoveClass(e,"ke_cell_border_r"),cellRemoveClass(g,"ke_cell_border_l"))):"right"==
a&&(b?(b.style.borderRight=f,cellRemoveClass(b,"ke_cell_border_r"),g&&(g.style.borderRight=f,cellRemoveClass(g,"ke_cell_border_r"))):(d&&(d.style.borderRight=f,cellRemoveClass(d,"ke_cell_border_r")),e&&(e.style.borderRight=f,cellRemoveClass(e,"ke_cell_border_r"))));else if(f[f.length-1]=="editor_line_"+a+"_img.gif"){document.getElementById("edge_"+a).src="../images/editor/dialog/editor_line_"+a+"_d_img.gif";var h=f="";c||(f="1px solid rgb(0, 0, 0)",h="1px");"top"==a?(d&&(d.style.borderTop=f,d.style.borderTopWidth=
h,c&&(d.className+=" ke_cell_border_t")),b&&(b.style.borderTop=f,b.style.borderTopWidth=h,c&&(b.className+=" ke_cell_border_t"))):"horizon"==a?(e&&(d.style.borderBottom=f,e.style.borderTop=f,d.style.borderBottomWidth=h,e.style.borderTopWidth=h,c&&(d.className+=" ke_cell_border_b",e.className+=" ke_cell_border_t")),g&&(b.style.borderBottom=f,g.style.borderTop=f,b.style.borderBottomWidth=h,g.style.borderTopWidth=h,c&&(b.className+=" ke_cell_border_b",g.className+=" ke_cell_border_t"))):"bottom"==a?
e?(e.style.borderBottom=f,e.style.borderBottomWidth=h,c&&(e.className+=" ke_cell_border_b"),g&&(g.style.borderBottom=f,g.style.borderBottomWidth=h,c&&(g.className+=" ke_cell_border_b"))):(d&&(d.style.borderBottom=f,d.style.borderBottomWidth=h,c&&(d.className+=" ke_cell_border_b")),b&&(b.style.borderBottom=f,b.style.borderBottomWidth=h,c&&(b.className+=" ke_cell_border_b"))):"left"==a?(d&&(d.style.borderLeft=f,d.style.borderLeftWidth=h,c&&(d.className+=" ke_cell_border_l")),e&&(e.style.borderLeft=
f,e.style.borderLeftWidth=h,c&&(e.className+=" ke_cell_border_l"))):"vertical"==a?(b&&(d.style.borderRight=f,b.style.borderLeft=f,d.style.borderRightWidth=h,b.style.borderLeftWidth=h,c&&(d.className+=" ke_cell_border_r",b.className+=" ke_cell_border_l")),g&&(e.style.borderRight=f,g.style.borderLeft=f,e.style.borderRightWidth=h,g.style.borderLeftWidth=h,c&&(e.className+=" ke_cell_border_r",g.className+=" ke_cell_border_l"))):"right"==a&&(b?(b.style.borderRight=f,b.style.borderRightWidth=h,c&&(b.className+=
" ke_cell_border_r"),g&&(g.style.borderRight=f,g.style.borderRightWidth=h,c&&(g.className+=" ke_cell_border_r"))):(d&&(d.style.borderRight=f,d.style.borderRightWidth=h,c&&(d.className+=" ke_cell_border_r")),e&&(e.style.borderRight=f,e.style.borderRightWidth=h,c&&(e.className+=" ke_cell_border_r"))))}}
function cellRemoveClass(a,c){var d=new RegExp("(\\s|^)"+c+"(\\s|$)");d.test(a.className)&&(a.className=LayerWin.KEDITORTOP.RAONKEDITOR.util.trim(a.className.replace(d," ")));""==LayerWin.KEDITORTOP.RAONKEDITOR.util.trim(a.className)&&a.removeAttribute("class")}
function edgeNoneTotalClick(a,c){if("user"!=a){var d="";if(""==document.getElementById("line_kind").value){if(""==document.getElementById("line_thickness").value)return;d+=document.getElementById("line_thickness").value+"px"}else d+=document.getElementById("line_kind").value;var d=d+(" "+document.getElementById("line_style").style.borderTopStyle),d=d+(" "+document.getElementById("line_color").style.borderTopColor),b=document.getElementById("topcell1"),e=document.getElementById("topcell2"),g=document.getElementById("bottomcell1"),
f=document.getElementById("bottomcell2"),h=document.getElementById("edge_top"),k=document.getElementById("edge_horizon"),l=document.getElementById("edge_bottom"),m=document.getElementById("edge_left"),p=document.getElementById("edge_vertical"),n=document.getElementById("edge_right");"total"==a?(h&&(h.src="../images/editor/dialog/editor_line_top_img.gif"),k&&(k.src="../images/editor/dialog/editor_line_horizon_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_bottom_img.gif"),m&&(m.src="../images/editor/dialog/editor_line_left_img.gif"),
p&&(p.src="../images/editor/dialog/editor_line_vertical_img.gif"),n&&(n.src="../images/editor/dialog/editor_line_right_img.gif"),b&&(b.style.borderTop=d,b.style.borderBottom=d,b.style.borderRight=d,b.style.borderLeft=d,cellRemoveClass(b,"ke_cell_border_l"),cellRemoveClass(b,"ke_cell_border_r"),cellRemoveClass(b,"ke_cell_border_t"),cellRemoveClass(b,"ke_cell_border_b")),e&&(e.style.borderTop=d,e.style.borderLeft=d,e.style.borderRight=d,e.style.borderBottom=d,cellRemoveClass(e,"ke_cell_border_l"),cellRemoveClass(e,
"ke_cell_border_r"),cellRemoveClass(e,"ke_cell_border_t"),cellRemoveClass(e,"ke_cell_border_b")),g&&(g.style.borderTop=d,g.style.borderBottom=d,g.style.borderRight=d,g.style.borderLeft=d,cellRemoveClass(g,"ke_cell_border_l"),cellRemoveClass(g,"ke_cell_border_r"),cellRemoveClass(g,"ke_cell_border_t"),cellRemoveClass(g,"ke_cell_border_b")),f&&(f.style.borderTop=d,f.style.borderLeft=d,f.style.borderRight=d,f.style.borderBottom=d,cellRemoveClass(f,"ke_cell_border_l"),cellRemoveClass(f,"ke_cell_border_r"),
cellRemoveClass(f,"ke_cell_border_t"),cellRemoveClass(f,"ke_cell_border_b"))):"inside"==a?(h&&(h.src="../images/editor/dialog/editor_line_top_img.gif",edgeClick("top",c)),l&&(l.src="../images/editor/dialog/editor_line_bottom_img.gif",edgeClick("bottom",c)),m&&(m.src="../images/editor/dialog/editor_line_left_img.gif",edgeClick("left",c)),n&&(n.src="../images/editor/dialog/editor_line_right_img.gif",edgeClick("right",c)),edgeSelectClick(2,"inside"),k&&(k.src="../images/editor/dialog/editor_line_horizon_img.gif"),
p&&(p.src="../images/editor/dialog/editor_line_vertical_img.gif"),b&&e&&(b.style.borderRight=d,e.style.borderLeft=d,cellRemoveClass(b,"ke_cell_border_r"),cellRemoveClass(e,"ke_cell_border_l")),g&&f&&(g.style.borderRight=d,f.style.borderLeft=d,cellRemoveClass(g,"ke_cell_border_r"),cellRemoveClass(f,"ke_cell_border_l")),b&&g&&(b.style.borderBottom=d,g.style.borderTop=d,cellRemoveClass(b,"ke_cell_border_b"),cellRemoveClass(g,"ke_cell_border_t")),e&&f&&(e.style.borderBottom=d,f.style.borderTop=d,cellRemoveClass(e,
"ke_cell_border_b"),cellRemoveClass(f,"ke_cell_border_t"))):"outside"==a?(k&&(k.src="../images/editor/dialog/editor_line_horizon_img.gif",edgeClick("horizon",c)),p&&(p.src="../images/editor/dialog/editor_line_vertical_img.gif",edgeClick("vertical",c)),edgeSelectClick(1,"outside"),h&&(h.src="../images/editor/dialog/editor_line_top_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_bottom_img.gif"),m&&(m.src="../images/editor/dialog/editor_line_left_img.gif"),n&&(n.src="../images/editor/dialog/editor_line_right_img.gif"),
b&&e?(b.style.borderTop=d,b.style.borderLeft=d,e.style.borderTop=d,e.style.borderRight=d,cellRemoveClass(b,"ke_cell_border_t"),cellRemoveClass(b,"ke_cell_border_l"),cellRemoveClass(e,"ke_cell_border_t"),cellRemoveClass(e,"ke_cell_border_r")):b&&(b.style.borderTop=d,b.style.borderLeft=d,b.style.borderRight=d,cellRemoveClass(b,"ke_cell_border_t"),cellRemoveClass(b,"ke_cell_border_l"),cellRemoveClass(b,"ke_cell_border_r")),g&&f?(g.style.borderLeft=d,g.style.borderBottom=d,f.style.borderRight=d,f.style.borderBottom=
d,cellRemoveClass(g,"ke_cell_border_l"),cellRemoveClass(g,"ke_cell_border_b"),cellRemoveClass(f,"ke_cell_border_r"),cellRemoveClass(f,"ke_cell_border_b")):g?(g.style.borderLeft=d,g.style.borderRight=d,g.style.borderBottom=d,cellRemoveClass(g,"ke_cell_border_l"),cellRemoveClass(g,"ke_cell_border_r"),cellRemoveClass(g,"ke_cell_border_b")):(b&&(b.style.borderBottom=d,cellRemoveClass(b,"ke_cell_border_b")),e&&(e.style.borderBottom=d,cellRemoveClass(e,"ke_cell_border_b")))):"none"==a&&(h&&(h.src="../images/editor/dialog/editor_line_top_d_img.gif"),
k&&(k.src="../images/editor/dialog/editor_line_horizon_d_img.gif"),l&&(l.src="../images/editor/dialog/editor_line_bottom_d_img.gif"),m&&(m.src="../images/editor/dialog/editor_line_left_d_img.gif"),p&&(p.src="../images/editor/dialog/editor_line_vertical_d_img.gif"),n&&(n.src="../images/editor/dialog/editor_line_right_d_img.gif"),b&&(b.className="ke_cell_border_t ke_cell_border_l ke_cell_border_r ke_cell_border_b"),e&&(e.className="ke_cell_border_t ke_cell_border_l ke_cell_border_r ke_cell_border_b"),
g&&(g.className="ke_cell_border_t ke_cell_border_l ke_cell_border_r ke_cell_border_b"),f&&(f.className="ke_cell_border_t ke_cell_border_l ke_cell_border_r ke_cell_border_b"))}}function fnLineStyleToggle(){var a=document.getElementById("line_style_list");a.style.display="none"==a.style.display?"block":"none"}
function lineStyleChange(){var a=document.getElementById("line_style"),c=document.getElementById("line_thickness");if("hidden"==a.style.borderTopStyle||"none"==a.style.borderTopStyle)c.value="0";else if("solid"!=a.style.borderTopStyle&&"dotted"!=a.style.borderTopStyle&&"dashed"!=a.style.borderTopStyle&&"hidden"!=a.style.borderTopStyle&&"none"!=a.style.borderTopStyle){if(isNaN(parseInt(c.value,10))||3>parseInt(c.value,10))c.value="3"}else if(isNaN(parseInt(c.value,10))||0>=parseInt(c.value,10))c.value=
"1";edgeNoneTotalClick(LayerWin._k_editor.applyEdgeMode)}function lineKindChange(){var a=document.getElementById("line_kind"),c=document.getElementById("line_thickness"),d=document.getElementById("line_thickness_updn_btn");""!=a.value?(c.disabled=!0,d.style.display="none","medium"==a.value?c.value="3":"thin"==a.value?c.value="1":"thick"==a.value&&(c.value="5")):(c.disabled=!1,d.style.display="block");edgeNoneTotalClick(LayerWin._k_editor.applyEdgeMode)}
function imgLineKindChange(){var a=document.getElementById("line_kind"),c=document.getElementById("line_thickness"),d=document.getElementById("line_thickness_updn_btn");""!=a.value?(c.disabled=!0,c.value="",d.style.display="none"):(c.disabled=!1,d.style.display="block")}function lineThicknessChange(){var a=document.getElementById("line_thickness");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._k_editor.applyEdgeMode)}
function cellGapChange(){var a=document.getElementById("cell_gap");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._k_editor.applyEdgeMode)}function insideMarginChange(){var a=document.getElementById("cell_inside_margin");10<a.value&&(a.value=10);edgeNoneTotalClick(LayerWin._k_editor.applyEdgeMode)}function tableEdgeReduceChange(){edgeNoneTotalClick(LayerWin._k_editor.applyEdgeMode)}
function getColorHex(a){return-1<a.indexOf("#")?a:LayerWin.KEDITORTOP.RAONKEDITOR.util.rgb2hex(a)?LayerWin.KEDITORTOP.RAONKEDITOR.util.rgb2hex(a):"#000000"}
function setLineStyleEvt(){var a=document.getElementById("ul_line_style");LayerWin.KEDITORTOP.RAONKEDITOR.util.addEvent(a,"click",function(a){var d=document.getElementById("line_style");a=LayerWin.getClickCell(a,"li").getElementsByTagName("SPAN")[0];d.style.border="";"solid"==a.style.borderTopStyle||"dotted"==a.style.borderTopStyle||"dashed"==a.style.borderTopStyle||"double"==a.style.borderTopStyle||"hidden"==a.style.borderTopStyle||"none"==a.style.borderTopStyle?d.style.borderTop=a.style.borderTop:
d.style.border=a.style.border;fnLineStyleToggle();setCursorPos(document.getElementById("line_style_btn"),!1,!1);lineStyleChange()})}
function setCellBorderModifyValue(a){var c=LayerWin.KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT;if(a){a=LayerWin.GetTableSelectionCells(c);for(var c=a.length,d=!0,b=0;b<c-1;b++){if(a[b].style.borderTopStyle!=a[b+1].style.borderTopStyle||a[b].style.borderTopWidth!=a[b+1].style.borderTopWidth||a[b].style.borderTopColor!=a[b+1].style.borderTopColor){d=!1;break}if(a[b].style.borderRightStyle!=a[b+1].style.borderRightStyle||a[b].style.borderRightWidth!=a[b+1].style.borderRightWidth||a[b].style.borderRightColor!=
a[b+1].style.borderRightColor){d=!1;break}if(a[b].style.borderBottomStyle!=a[b+1].style.borderBottomStyle||a[b].style.borderBottomWidth!=a[b+1].style.borderBottomWidth||a[b].style.borderBottomColor!=a[b+1].style.borderBottomColor){d=!1;break}if(a[b].style.borderLeftStyle!=a[b+1].style.borderLeftStyle||a[b].style.borderLeftWidth!=a[b+1].style.borderLeftWidth||a[b].style.borderLeftColor!=a[b+1].style.borderLeftColor){d=!1;break}}d?setModifyValue(a[0].style,!0):setModifyValue(null)}else setModifyValue(c.style,
!0)}
function setTableBorderModifyValue(a){if("separate"==a.style.borderCollapse)setModifyValue(a.style,!0);else{var c=!0,d=!0,b=!0,e=!0,g,f,h,k;a=LayerWin.getTableBorderCells(a);var l=a.arrTop.length;if(1==l)g=a.arrTop[0].style.borderTop;else for(var m=0;m<l;m++)0!=m&&(a.arrTop[m-1].style.borderTop!=a.arrTop[m].style.borderTop&&(c=!1),m==l-1&&c&&(g=a.arrTop[m].style.borderTop));l=a.arrLeft.length;if(1==l)h=a.arrLeft[0].style.borderLeft;else for(m=0;m<l;m++)0!=m&&(a.arrLeft[m-1].style.borderLeft!=a.arrLeft[m].style.borderLeft&&
(e=!1),m==l-1&&e&&(h=a.arrLeft[m].style.borderLeft));l=a.arrRight.length;if(1==l)k=a.arrRight[0].style.borderRight;else for(m=0;m<l;m++)0!=m&&(a.arrRight[m-1].style.borderRight!=a.arrRight[m].style.borderRight&&(b=!1),m==l-1&&b&&(k=a.arrRight[m].style.borderRight));l=a.arrBottom.length;if(1==l)f=a.arrBottom[0].style.borderBottom;else for(m=0;m<l;m++)0!=m&&(a.arrBottom[m-1].style.borderBottom!=a.arrBottom[m].style.borderBottom&&(d=!1),m==l-1&&d&&(f=a.arrBottom[m].style.borderBottom));a=document.createElement("td");
a.style.borderTop=g?g:"1px solid #000000";a.style.borderBottom=f?f:"1px solid #000000";a.style.borderLeft=h?h:"1px solid #000000";a.style.borderRight=k?k:"1px solid #000000";g=!1;a.style.borderTop==a.style.borderRight&&a.style.borderRight==a.style.borderBottom&&a.style.borderBottom==a.style.borderLeft&&c&&d&&b&&e&&(g=!0);setModifyValue(a.style,g)}}
function setModifyValue(a,c){if(a){var d=c,b,e,g,f;b=a.borderTopWidth;e=a.borderBottomWidth;g=a.borderRightWidth;f=a.borderLeftWidth;b==e&&e==g&&g==f?-1<b.indexOf("px")?document.getElementById("line_thickness").value=parseInt(b,10):document.getElementById("line_kind").value=b:(document.getElementById("line_thickness").value="1",document.getElementById("line_kind").value="");b+=" ";e+=" ";g+=" ";f+=" ";a.borderTopStyle==a.borderRightStyle&&a.borderRightStyle==a.borderLeftStyle&&a.borderLeftStyle==
a.borderBottomStyle?("solid"==a.borderStyle||"dotted"==a.borderStyle||"dashed"==a.borderStyle||"double"==a.borderStyle||"hidden"==a.borderStyle||"none"==a.borderStyle?document.getElementById("line_style").style.borderTopStyle=a.borderStyle:document.getElementById("line_style").style.borderStyle=a.borderStyle,"solid"!=a.borderTopStyle&&"dotted"!=a.borderTopStyle&&"dashed"!=a.borderTopStyle&&"hidden"!=a.borderTopStyle&&"none"!=a.borderTopStyle?(document.getElementById("line_style").style.borderWidth=
"3px","double"==a.borderTopStyle?document.getElementById("line_style").style.borderColor="#5d5d5d":document.getElementById("line_style").style.borderColor="#e1e1e1"):(document.getElementById("line_style").style.borderTopWidth="1px",document.getElementById("line_style").style.borderTopColor="#5d5d5d")):(document.getElementById("line_style").style.borderTopStyle="none",d=!1);b+=a.borderTopStyle+" ";e+=a.borderBottomStyle+" ";g+=a.borderRightStyle+" ";f+=a.borderLeftStyle+" ";var h=getColorHex(a.borderTopColor),
k=getColorHex(a.borderBottomColor),l=getColorHex(a.borderRightColor),m=getColorHex(a.borderLeftColor);h==k&&k==l&&l==m&&(document.getElementById("line_color").style.borderTopColor=h);b+=h;e+=k;g+=l;f+=m;document.getElementById("edge_border").style.borderTop=b;document.getElementById("edge_border").style.borderBottom=e;document.getElementById("edge_border").style.borderRight=g;document.getElementById("edge_border").style.borderLeft=f;d||edgeNoneTotalClick("none")}else document.getElementById("line_style").style.borderTopStyle=
"none",edgeNoneTotalClick("none")}function setLayout(a){a=a.replace("te","");a={num:a};0==LayerWin.KEDITORTOP.RAONKEDITOR.isEmpty()?1==confirm(LayerWin.RAONKEditor_lang.msg.newDocument)&&LayerWin.event_keditor_layout(a,window.frameElement.parentNode.parentNode):LayerWin.event_keditor_layout(a,window.frameElement.parentNode.parentNode)}
function event_keditor_file_upload_completed(a){loading_image_show(!1);if(a&&""!=a){a=a.replace(/\r\n/g,"");a=a.replace(/\n/g,"");a=a.replace(/\t/g,"");try{var c={strUrl:a},d;d="function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl?KEDITORTOP.G_CURRKEDITOR._config.event.beforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,c):KEDITORTOP.KEDITORWIN.RAONKEDITOR_BeforeInsertUrl(KEDITORTOP.G_CURRKEDITOR.ID,c);null!=d&&void 0!=d&&(a=d)}catch(b){}}if("[FAIL]"==a.substring(0,6))try{if(c={strType:"fileUpload",
strMessage:a},0==("function"==typeof KEDITORTOP.G_CURRKEDITOR._config.event.onError?KEDITORTOP.G_CURRKEDITOR._config.event.onError(KEDITORTOP.G_CURRKEDITOR.ID,c):KEDITORTOP.KEDITORWIN.RAONKEDITOR_OnError(KEDITORTOP.G_CURRKEDITOR.ID,c)))return}catch(e){}if("[FAIL]"==a.substring(0,6))confirm(LayerWin.RAONKEditor_lang.msg.uploadFailed)&&alert(a);else{var c=document.getElementById("file_title").value,g=document.getElementById("file_text").value;d=document.getElementById("input_id").value;var f=document.getElementById("input_class").value;
if(""==g)if("1"==LayerWin._k_editor._config.useKManager)g=getFileName(G_dragDropFileObj[0].path);else var h=document.getElementById(file_field_id).value,g=getFileName(h);h=a;null!=a&void 0!=a&&(a=a.split("?"),2==a.length&&(h=a[0],a=a[1].split("^"),3==a.length&&(h+="?"+a[2])),""==g&&(a=h.split("/"),g=a[a.length-1]));a=h.substring(h.lastIndexOf(".")+1).toLowerCase();a=a.toLowerCase();LayerWin.insertElementsSrc(KEDITORTOP.G_CURRKEDITOR,h);c={text:g,url:h,target:"_blank",title:c,type:"hyperlink",type2:"insert_file",
file_ext:a,id:d,className:f};elemModify&&"a"==elemModify.tagName.toLowerCase()?(elemModify.innerHTML=c.text,elemModify.title=c.title,elemModify.id=c.id,elemModify.className=c.className,elemModify.href=c.url,"1"==LayerWin._k_editor._config.attachFileImage&&LayerWin.attachFileImage(elemModify,c),LayerWin._k_editor.UndoManager.putUndo(),event_popup_close()):LayerWin.event_keditor_insert_file(c,window.frameElement.parentNode.parentNode)}}
function keditor_upload_file(){var a=document.keditor_upload_form,c,d="";"1"==LayerWin._k_editor._config.useKManager?G_dragDropFileObj&&G_dragDropFileObj[0]&&(d=G_dragDropFileObj[0].path):(c=""==document.getElementById(file_field_id).value?G_dragDropFileObj&&G_dragDropFileObj[0]?{value:G_dragDropFileObj[0].name,id:document.getElementById(file_field_id).id}:{value:""}:document.getElementById(file_field_id),d=c.value);if(0<d.lastIndexOf(".")){for(var b=d.substring(d.lastIndexOf(".")+1).toLowerCase(),
e=!1,g=LayerWin._k_editor._config.allowInsertFileType,f=g.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,h=g.length,k=0;k<h;k++)if(b==g[k]){e=!0;break}document.getElementById("file_text");if(1==e)if(loading_image_show(!0),"1"==LayerWin._k_editor._config.useKManager)c=function(a){event_keditor_file_upload_completed(a[0].path)},a=[],d={guid:"cid:"+KEDITORTOP.RAONKEDITOR.util.makeGuid(),path:d,callback:c},a.push(d),LayerWin.agentFileUpload(LayerWin._k_editor,a,c);else if("1"==LayerWin._k_editor._config.uploadUseHTML5){a=
new KEDITORTOP.RAONKEDITOR.util.hashTable;b=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c01"+KEDITORTOP.RAONKSolution.Agent.vertical);b+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+d.substring(d.lastIndexOf("\\")+1)+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRule+
KEDITORTOP.RAONKSolution.Agent.vertical;b+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical;b+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+LayerWin._k_editor._config.saveFolderNameRule;b=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(b);a.setItem("k00",b);d=LayerWin.G_FormData.length;for(b=0;b<d;b++)e=LayerWin.G_FormData[b].form_value,e="1"==KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam?KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(e):encodeURIComponent(e),
a.setItem(LayerWin.G_FormData[b].form_name,e);uploadAjaxOnprogressStart({uploadType:"insert_file",handlerUrl:LayerWin._k_editor._config.handlerUrl,fileID:c.id,fileObj:G_dragDropFileObj,formData:a},event_keditor_file_upload_completed)}else a.action=document.getElementById("upload_url").value,a.submit();else alert(f)}else alert(LayerWin.RAONKEditor_lang.msg.alert_exec)}function getFileName(a){var c="";if(a&&0<a.length)return c=a,a=a.split("\\"),0<a.length&&(c=a[a.length-1]),c}
function htmlSpecialChars(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;")}
function keditor_upload_open_file(){var a=document.keditor_upload_form,c=document.getElementById(file_field_id),d=c.value;if(0<d.lastIndexOf(".")){for(var d=d.substring(d.lastIndexOf(".")+1).toLowerCase(),b=!1,e=["htm","html","txt"],g=e.toString()+LayerWin.RAONKEditor_lang.msg.alert_exec_tail,f=e.length,h=0;h<f;h++)if(d==e[h]){b=!0;break}if(1==b){if(0!=KEDITORTOP.RAONKEDITOR.isEmpty()||0!=confirm(LayerWin.RAONKEditor_lang.msg.newDocument))"1"==LayerWin._k_editor._config.openDocument.useHtml5FileOpen?
(loading_image_show(!0),handleFileSelect(c.files)):(loading_image_show(!0),c=""+("kc"+KEDITORTOP.RAONKSolution.Agent.formfeed+"c02"+KEDITORTOP.RAONKSolution.Agent.vertical),c+="k01"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.security.encryptParam+KEDITORTOP.RAONKSolution.Agent.vertical,c+="k14"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.RAONKEDITOR.util.makeGuid()+".html"+KEDITORTOP.RAONKSolution.Agent.vertical,c+="k15"+KEDITORTOP.RAONKSolution.Agent.formfeed+
KEDITORTOP.G_CURRKEDITOR._config.saveFileNameRule+KEDITORTOP.RAONKSolution.Agent.vertical,c+="k16"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.saveFileNameRuleEx+KEDITORTOP.RAONKSolution.Agent.vertical,c+="k17"+KEDITORTOP.RAONKSolution.Agent.formfeed+KEDITORTOP.G_CURRKEDITOR._config.saveFolderNameRule,c=KEDITORTOP.RAONKEDITOR.util.makeEncryptParam(c),d=document.createElement("input"),d.type="hidden",d.id="k00",d.name="k00",d.value=c,a.appendChild(d),a.action=document.getElementById("upload_url").value,a.submit())}else alert(g)}else alert(LayerWin.RAONKEditor_lang.msg.alert_exec)}
function event_keditor_open_file_upload_completed(a){var c=document.getElementById(file_field_id).value;a={fileExt:c.substring(c.lastIndexOf(".")+1).toLowerCase(),data:a};LayerWin.event_keditor_insert_open_file(a,window.frameElement.parentNode.parentNode)}function keditor_blockquote(){var a={tagvalue:document.getElementById("tempblockquote").value};LayerWin.event_keditor_insert_blockquote(a,window.frameElement.parentNode.parentNode)}
function keditor_blockquoteCancel(){LayerWin.event_keditor_cancel_blockquote(window.frameElement.parentNode.parentNode)}
function keditor_setAccessibility(a,c){var d=document.getElementById("input_title").value,b=document.getElementById("input_alt").value,e=document.getElementById("chk_skip").checked,g=document.getElementById("input_id").value,f;c.parentNode.cells[1].getElementsByTagName("span")[2]&&(f=c.parentNode.cells[1].getElementsByTagName("span")[2].innerHTML);var h=!1;""==document.getElementById("id_tr").style.display&&(h=!0);LayerWin.event_keditor_setAccessibility({title:d,alt:b,skip:e,id:g,idSamMode:h,sameOrgId:f},
a,c)}
function fileOnchange(a,c){var d;"0"==KEDITORTOP.G_CURRKEDITOR._config.insertMultiImage&&(d=1);if(fileDataObj=document.getElementById(LayerWin._k_editor._config.fileFieldID))if(fileDataObj&&fileDataObj.value){if(("1"==LayerWin._k_editor._config.uploadUseHTML5||"insert_file"==c)&&void 0!=c){var b=getFileName(fileDataObj.value);document.getElementById("file_text").value=b}}else"1"!=LayerWin._k_editor._config.uploadUseHTML5&&"insert_file"==c&&(KEDITORTOP.RAONKEDITOR.browser.chrome||KEDITORTOP.RAONKEDITOR.browser.opera)?document.getElementById("file_text").value=
"":"1"==LayerWin._k_editor._config.useKManager&&a&&a.files&&0<a.files.length&&"insert_file"==c&&(document.getElementById("file_text").value=a.files[0].name);var b=document.getElementById("img_alt"),e=document.getElementById("file_text");null!=b&&null!=e&&b&&""!=e.value&&(b.value=LayerWin.getFileName(e.value,!0));c&&a&&a.files&&0<a.files.length&&("1"==LayerWin._k_editor._config.uploadUseHTML5||"1"==LayerWin._k_editor._config.useKManager)&&(G_dragDropFileObj=a.files,d=G_dragDropFileObj.length);G_dragDropFileObj&&
(1==d?document.getElementById("drop_zone").innerHTML=G_dragDropFileObj[0].name:document.getElementById("drop_zone").innerHTML=d+"\uac1c \ud30c\uc77c",document.getElementById("drop_zone").className="K_edITor_ED_Popup_DropZoneNoneBackground");if(c&&(a&&a.files&&0<a.files.length||G_dragDropFileObj)&&("1"==LayerWin._k_editor._config.useKManager||KEDITORTOP.RAONKEDITOR.browser.HTML5Supported)){var b=!1,e=LayerWin.RAONKEditor_lang.msg.max_file_size,g=0;if(a&&a.files&&0<a.files.length)for(var f=a.files.length,
h=0;h<f;h++)g+=a.files[h].size;else for(f=G_dragDropFileObj.length,h=0;h<f;h++)g=G_dragDropFileObj[h].size;("image"==c||"m_image"==c||"input_image"==c||"hyperlink_image"==c)&&0!=LayerWin._k_editor._config.maxImageFileSize&&g>LayerWin._k_editor._config.maxImageFileSize?(e=e.replace("{0}",KEDITORTOP.RAONKEDITOR.util.bytesToSize(LayerWin._k_editor._config.maxImageFileSize).toString),b=!0):"media"==c&&0!=LayerWin._k_editor._config.maxMediaFileSize&&g>LayerWin._k_editor._config.maxMediaFileSize?(e=e.replace("{0}",
KEDITORTOP.RAONKEDITOR.util.bytesToSize(LayerWin._k_editor._config.maxMediaFileSize).toString),b=!0):"flash"==c&&0!=LayerWin._k_editor._config.maxFlashFileSize&&g>LayerWin._k_editor._config.maxFlashFileSize?(e=e.replace("{0}",KEDITORTOP.RAONKEDITOR.util.bytesToSize(LayerWin._k_editor._config.maxFlashFileSize).toString),b=!0):"insert_file"==c&&0!=LayerWin._k_editor._config.maxInsertFileSize&&g>LayerWin._k_editor._config.maxInsertFileSize&&(e=e.replace("{0}",KEDITORTOP.RAONKEDITOR.util.bytesToSize(LayerWin._k_editor._config.maxInsertFileSize).toString),
b=!0);if(b){alert(e);"1"==LayerWin._k_editor._config.uploadUseHTML5||"1"==LayerWin._k_editor._config.useKManager?(1==KEDITORTOP.RAONKEDITOR.browser.mobile?document.getElementById("drop_zone").innerHTML=LayerWin.RAONKEditor_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.RAONKEditor_lang.upload.drop_zone_content,G_dragDropFileObj=null):document.getElementById("image_url").value="";a.value="";return}}"1"!=LayerWin._k_editor._config.useKManager||"image"!=c&&"input_image"!=
c||(e=b="","image"==c?(b="img_width",e="img_height"):"input_image"==c&&(b="input_width",e="input_height"),document.getElementById("original_image_width").value=G_dragDropFileObj[0].width,document.getElementById("original_image_height").value=G_dragDropFileObj[0].height,1==d?(g=LayerWin._k_editor._config.imgDefaultWidth,f=LayerWin._k_editor._config.imgDefaultHeight,""!=g?KEDITORTOP.RAONKEDITOR.util.parseIntOr0(G_dragDropFileObj[0].width)>KEDITORTOP.RAONKEDITOR.util.parseIntOr0(g)&&(f=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(G_dragDropFileObj[0].height,
10)*KEDITORTOP.RAONKEDITOR.util.parseIntOr0(g,10)/KEDITORTOP.RAONKEDITOR.util.parseIntOr0(G_dragDropFileObj[0].width,10),document.getElementById(e).value=isNaN(f)?G_dragDropFileObj[0].height:Math.round(f),document.getElementById(b).value=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(g)):""!=f?KEDITORTOP.RAONKEDITOR.util.parseIntOr0(G_dragDropFileObj[0].height)>KEDITORTOP.RAONKEDITOR.util.parseIntOr0(f)&&(g=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(G_dragDropFileObj[0].width,10)*KEDITORTOP.RAONKEDITOR.util.parseIntOr0(f,
10)/KEDITORTOP.RAONKEDITOR.util.parseIntOr0(G_dragDropFileObj[0].height,10),document.getElementById(b).value=isNaN(g)?G_dragDropFileObj[0].width:Math.round(g),document.getElementById(e).value=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(f)):(document.getElementById(b).value=G_dragDropFileObj[0].width,document.getElementById(e).value=G_dragDropFileObj[0].height)):(document.getElementById(b).value="",document.getElementById(e).value=""));if(("image"==c||"m_image"==c)&&"base64"==LayerWin._k_editor._config.uploadMethod&&
null==elemModify&&(a&&a.files&&0<a.files.length||G_dragDropFileObj)&&"-1"!=LayerWin._k_editor._config.maxImageBase64fileCount&&LayerWin.getBase64ImageCount()>=parseInt(LayerWin._k_editor._config.maxImageBase64fileCount,10))e=LayerWin.RAONKEditor_lang.msg.max_base64file_count,e=e.replace("{0}",LayerWin._k_editor._config.maxImageBase64fileCount),alert(e),"1"==LayerWin._k_editor._config.uploadUseHTML5||"1"==LayerWin._k_editor._config.useKManager?(1==KEDITORTOP.RAONKEDITOR.browser.mobile?document.getElementById("drop_zone").innerHTML=
LayerWin.RAONKEditor_lang.upload.drop_zone_content2:document.getElementById("drop_zone").innerHTML=LayerWin.RAONKEditor_lang.upload.drop_zone_content,G_dragDropFileObj=null):document.getElementById("image_url").value="",a.value="";else{document.getElementById("image_url")&&(b=a.value.split("\\"),document.getElementById("image_url").value=b[b.length-1]);"image"==c&&(1==d?document.getElementById("img_id").disabled=!1:(document.getElementById("img_id").value="",document.getElementById("img_id").disabled=
!0));try{if("0"==LayerWin._k_editor._config.useKManager&&("image"==c||"m_image"==c)&&(a.files&&a.files[0]||a[0])){var k=window.URL||window.webkitURL||window,l=a[0]?a:a.files,m=l.length;g_curr_width=[];g_curr_height=[];for(h=0;h<m;h++){var p=k.createObjectURL(l[h]),n=new Image;n.onload=function(){try{(window.URL||window.webkitURL||window).revokeObjectURL(this.src)}catch(a){}var b=document.getElementById("img_width_unit"),c=document.getElementById("img_height_unit"),d=!1,e=!1;b&&"%"==b.value&&(d=!0);
c&&"%"==c.value&&(e=!0);!d&&!e&&(b=n.width,c=n.height,d=LayerWin._k_editor._config.imgDefaultWidth,e=LayerWin._k_editor._config.imgDefaultHeight,""!=d?KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b)>KEDITORTOP.RAONKEDITOR.util.parseIntOr0(d)&&(b=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(c,10)*KEDITORTOP.RAONKEDITOR.util.parseIntOr0(d,10)/KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b,10),c=isNaN(b)?c:Math.round(b),b=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(d)):""!=e&&KEDITORTOP.RAONKEDITOR.util.parseIntOr0(c)>
KEDITORTOP.RAONKEDITOR.util.parseIntOr0(e)&&(c=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b,10)*KEDITORTOP.RAONKEDITOR.util.parseIntOr0(e,10)/KEDITORTOP.RAONKEDITOR.util.parseIntOr0(c,10),b=isNaN(c)?b:Math.round(c),c=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(e)),g_curr_width.push(b),g_curr_height.push(c),document.getElementById("img_width").value=b,document.getElementById("img_height").value=c,d=document.getElementById("img_ratio"))&&("true"!=d.getAttribute("ratio-checked")&&d.click(),KEDITORTOP.RAONKEDITOR.browser.mobile?
(d.style.display="none",document.getElementById("img_ratio_view").style.display=""):d.style.display="",addEventImgWidthHeight(b,c));n=null;n=void 0};n.src=p}}}catch(q){}}}
function set_page_table_lock_property(){KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("ok_btn"),"click",function(){applyTableLockProperty()});var a=LayerWin.GetParentbyTagName(KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT,"table",!0);if(a){var c=LayerWin.checkLockAttr(a,!0),d=document.getElementsByName("table_lock");c?(d[0].checked=!0,d[1].checked=!1):(d[0].checked=!1,d[1].checked=!0);a.getAttribute("lock_mode")&&(b=a.getAttribute("lock_mode"));c=document.getElementsByName("lock_mode");
"1"==b?(c[0].checked=!0,c[1].checked=!1):(c[0].checked=!1,c[1].checked=!0);var b=KEDITORTOP.G_CURRKEDITOR._config.defaultTableLockMode;a.getAttribute("lock_mode")&&(b=a.getAttribute("lock_mode"));c=document.getElementsByName("lock_mode");"1"==b?(c[0].checked=!0,c[1].checked=!1):(c[0].checked=!1,c[1].checked=!0);b=KEDITORTOP.G_CURRKEDITOR._config.defaultShowLockIconUserMode;a.getAttribute("show_icon")&&(b=a.getAttribute("show_icon"));a=document.getElementsByName("lock_icon_option");"0"==b?(a[1].checked=
!0,a[0].checked=!1):(a[1].checked=!1,a[0].checked=!0)}}
function applyTableLockProperty(){var a=LayerWin.GetParentbyTagName(KEDITORTOP.RAONKEDITOR.G_SELECTED_ELEMENT,"table",!0);a&&(document.getElementsByName("table_lock")[0].checked?(LayerWin.setClassName(a,"k_editor_table_lock"),a.setAttribute(KEDITORTOP.G_CURRKEDITOR._config.adminTableLock.defaultLockName,""),document.getElementsByName("lock_mode")[0].checked?a.setAttribute("lock_mode","1"):a.setAttribute("lock_mode","2"),document.getElementsByName("lock_icon_option")[0].checked?a.setAttribute("show_icon",
"1"):a.setAttribute("show_icon","0")):(LayerWin.removeLockAttr(a),LayerWin.removeClassName(a,"k_editor_table_lock"),a.removeAttribute("lock_mode"),a.removeAttribute("show_icon")),a=LayerWin.getFirstRange().range.startContainer,3==a.nodeType&&(a=a.parentNode),a&&1==a.nodeType&&LayerWin.setMenuIconRealable(a));event_popup_close()}
function setBorderListValue(a,c){switch(a){case "none":c.style.borderTopStyle="none";break;case "solid":c.style.borderTop="1px solid rgb(93, 93, 93)";break;case "dotted":c.style.borderTop="1px dotted rgb(93, 93, 93)";break;case "dashed":c.style.borderTop="1px dashed rgb(93, 93, 93)";break;case "double":c.style.border="3px double rgb(93, 93, 93)";break;case "groove":c.style.border="3px groove rgb(225, 225, 225)";break;case "ridge":c.style.border="3px ridge rgb(225, 225, 225)";break;case "inset":c.style.border=
"3px inset rgb(225, 225, 225)";break;case "outset":c.style.border="3px outset rgb(225, 225, 225)"}}
function paste_to_image_loaded_event(){var a=LayerWin._k_editor._config.style.skinName;document.getElementById("keditor_dialog_box").className="K_edITor_ED_Popup_Type06 K_edITor_PUi_"+a;var a=document.getElementById("html_btn"),c=document.getElementById("image_width"),d=document.getElementById("image_height"),b=document.getElementById("image_quality");document.getElementById("span_title").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.title;document.getElementById("span_save_client").innerHTML=
LayerWin.RAONKEditor_lang.paste_to_image.save_client;document.getElementById("legent_format").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.format;document.getElementById("label_quality").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.quality;document.getElementById("rotate").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.rotate;document.getElementById("size").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.size;document.getElementById("label_width").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.width;
document.getElementById("label_height").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.height;document.getElementById("lock_size_rate").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.lock_size_rate;document.getElementById("span_origin_size").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.origin_size;document.getElementById("dt_preview").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.preview;document.getElementById("label_lock_size_rate").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.lock_size_rate;
document.getElementById("label_lock_origin_size").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.lock_origin_size;""!=LayerWin._k_editor._config.buttonText001?document.getElementById("span_insert_image").innerHTML=LayerWin._k_editor._config.buttonText001:document.getElementById("span_insert_image").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.insert_image;document.getElementById("span_insert_html").innerHTML=LayerWin.RAONKEditor_lang.paste_to_image.insert_html;KEDITORTOP.RAONKEDITOR.util.addEvent(b,
"keydown",LayerWin.onlyNumber);KEDITORTOP.RAONKEDITOR.util.addEvent(b,"blur",function(){100<KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b.value)?b.value="100":0==KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b.value)&&(b.value="1")});KEDITORTOP.RAONKEDITOR.util.addEvent(c,"keydown",LayerWin.onlyNumber);KEDITORTOP.RAONKEDITOR.util.addEvent(d,"keydown",LayerWin.onlyNumber);KEDITORTOP.RAONKEDITOR.util.addEvent(c,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var a=parseInt(n,10)*parseInt(c.value,
10)/parseInt(p,10);d.value=isNaN(a)?d.value:Math.round(a)}});KEDITORTOP.RAONKEDITOR.util.addEvent(d,"keyup",function(){if(1==document.getElementById("lock_size_rate").checked){var a=parseInt(p,10)*parseInt(d.value,10)/parseInt(n,10);c.value=isNaN(a)?c.value:Math.round(a)}});KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("span_origin_size").parentNode,"click",function(){c.value=p;d.value=n});KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("lock_origin_size"),"click",function(){document.getElementById("lock_origin_size").checked?
(c.value=parseInt(document.getElementById("original_img_width").value,10),d.value=parseInt(document.getElementById("original_img_height").value,10),c.disabled=!0,d.disabled=!0):(c.disabled=!1,d.disabled=!1)});KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("quality_spinUp"),"click",function(){0==b.disabled&&LayerWin.click_plus_func(document.getElementById("image_quality"),100,10)});KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("quality_spinDown"),"click",function(){0==
b.disabled&&LayerWin.click_minus_func(document.getElementById("image_quality"),1,10)});var e=document.getElementById("canvas_preview"),g=e.getContext("2d"),f=window.URL||window.webkitURL||window,h=f.createObjectURL(KEDITORTOP.G_CURRKEDITOR.clipImageBlob),k=new Image,l,m,p,n,q=0,r=0,t=1;"Windows"==KEDITORTOP.RAONKEDITOR.UserAgent.os.name?imageType="jpeg":(imageType="png",document.getElementById("image_type_png").checked=!0,document.getElementById("image_type_jpg").parentNode.style.display="none",document.getElementById("label_quality").parentNode.style.display=
"none");var u={type:"",width:0,height:0,checkOriginSize:!1};0==KEDITORTOP.G_CURRKEDITOR.bTextorHtmlData&&(document.getElementById("html_btn").style.display="none",a=document.getElementById("image_btn"));KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("image_btn"),"click",function(){for(var a=0,f=document.getElementsByName("image_rotate"),h=f.length,l=0;l<h;l++)if(f[l].checked){a=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(f[l].value);break}f=1;0==b.disabled&&(f=1*KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b.value)/
100);var m=function(a){a&&(KEDITORTOP.G_CURRKEDITOR.clipImageBlob=a);u.type="image";u.width=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(c.value);u.height=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(d.value);u.checkOriginSize=document.getElementById("lock_origin_size").checked;a=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(document.getElementById("original_img_width").value);var b=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(document.getElementById("original_img_height").value);u.checkOriginSize&&(u.width=a,u.height=
b);LayerWin.command_pasteToImage(KEDITORTOP.G_CURRKEDITOR.ID,KEDITORTOP.G_CURRKEDITOR,u);k=void 0;event_popup_close()};0!=a||1!=f||"png"!=imageType?(e.style.display="none",90==a||270==a?(h=k.height,l=k.width):(h=k.width,l=k.height),e.width=h,e.height=l,g.save(),g.translate(e.width/2,e.height/2),g.rotate(a*Math.PI/180),g.clearRect(0,0,e.width,e.height),g.drawImage(k,-k.width/2,-k.height/2,k.width,k.height),g.restore(),e.toBlob(function(a){m(a)},"image/"+imageType,f)):m()});KEDITORTOP.RAONKEDITOR.util.addEvent(document.getElementById("html_btn"),
"click",function(){u.type="html";LayerWin.command_pasteToImage(KEDITORTOP.G_CURRKEDITOR.ID,KEDITORTOP.G_CURRKEDITOR,u);k=void 0;event_popup_close();KEDITORTOP.G_CURRKEDITOR.pasteTableParam.tableNode&&LayerWin.RAONK_EDITOR.prototype.dialog.show(KEDITORTOP.G_CURRKEDITOR._config.webPath.page,KEDITORTOP.G_CURRKEDITOR._config.pages.paste_table)});for(var y=document.getElementsByName("image_rotate"),v=y.length,w=0;w<v;w++){var z=function(a){return function(b){b=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(y[a].value);
g.save();g.clearRect(0,0,e.width,e.height);g.translate(e.width/2,e.height/2);g.rotate(b*Math.PI/180);g.drawImage(k,-l/2,-m/2,l,m);g.restore();var f;90==b||270==b?(b=k.height,f=k.width,p=k.height,n=k.width):(b=k.width,f=k.height,p=k.width,n=k.height);c.value=b;d.value=f}}(w);KEDITORTOP.RAONKEDITOR.util.addEvent(y[w],"click",z)}for(var x=document.getElementsByName("image_type"),v=x.length,w=0;w<v;w++)z=function(a){return function(c){c=x[a].value;"jpg"==c?(imageType="jpeg",b.disabled=!1):(imageType=
c,b.disabled=!0)}}(w),KEDITORTOP.RAONKEDITOR.util.addEvent(x[w],"click",z);b.value="100";setCursorPos(document.getElementById("image_type_jpg"),!1,!1);LayerWin.setFocusFirstAndLast(document,document.getElementById("image_type_jpg"),a);(function(a){k.onload=function(){p=k.width;n=k.height;document.getElementById("original_img_width").value=k.width;document.getElementById("original_img_height").value=k.height;var b=LayerWin._k_editor._config.imgDefaultWidth,h=LayerWin._k_editor._config.imgDefaultHeight;
""!=b?KEDITORTOP.RAONKEDITOR.util.parseIntOr0(p)>KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b)&&(h=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(n,10)*KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b,10)/KEDITORTOP.RAONKEDITOR.util.parseIntOr0(p,10),n=isNaN(h)?n:Math.round(h),p=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(b)):""!=h&&KEDITORTOP.RAONKEDITOR.util.parseIntOr0(n)>KEDITORTOP.RAONKEDITOR.util.parseIntOr0(h)&&(b=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(p,10)*KEDITORTOP.RAONKEDITOR.util.parseIntOr0(h,10)/KEDITORTOP.RAONKEDITOR.util.parseIntOr0(n,
10),p=isNaN(b)?p:Math.round(b),n=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(h));c.value=p;d.value=n;t=Math.min(e.width/k.width,e.height/k.height);1>t?(l=Math.round(k.width*t),m=Math.round(k.height*t)):(l=k.width,m=k.height,t=1);l<e.width&&(q=(e.width-l)/2);m<e.height&&(r=(e.height-m)/2);g.drawImage(k,q,r,l,m);try{f.revokeObjectURL(a)}catch(u){}};k.src=a})(h)}
function keditor_create_conversion(){var a={text:document.getElementById("targetContent").value};LayerWin.event_keditor_create_conversion(a,window.frameElement.parentNode.parentNode)}function keditor_calculator(){var a=document.getElementById("valueText");LayerWin.event_keditor_calculator(a.value,window.frameElement.parentNode.parentNode)}
function keditor_insert_placeholder(){var a={notice:""};a.notice=document.getElementById("input_notice").value;LayerWin.event_keditor_insert_placeholder(a,window.frameElement.parentNode.parentNode)}
function keditor_paragraph_attribute(){var a=document.getElementById("p_margin_left"),c=document.getElementById("p_margin_right"),d=document.getElementById("p_margin_top"),b=document.getElementById("p_margin_bottom"),e=document.getElementById("p_letter_spacing"),g=document.getElementById("p_word_spacing"),f=document.getElementById("p_text_indent"),h=document.getElementById("p_font_size"),k=document.getElementById("font_family_select"),l=document.getElementById("p_font_size_type");LayerWin.event_keditor_paragraph_attribute({marginLeft:a.value,
marginRight:c.value,marginTop:d.value,marginBottom:b.value,letterSpacing:e.value,wordSpacing:g.value,textIndent:f.value,fontSize:h.value,fontFamily:k.value,fontType:l.value},window.frameElement.parentNode.parentNode)}function keditor_paste_table(){for(var a="",c=document.getElementsByName("radio_select"),d=c.length,b=0;b<d;b++)if(1==c[b].checked){a=c[b].value;break}LayerWin.event_keditor_paste_table({type:a},window.frameElement.parentNode.parentNode)}
function set_paste_table_button(){for(var a=KEDITORTOP.G_CURRKEDITOR.pasteTableParam.tableNode,c=0,d=0,c=a.rows.length,b=0;b<c;b++){var e=a.rows[b].cells.length;d<e&&(d=e)}for(var a=KEDITORTOP.G_CURRKEDITOR.pasteTableParam.currTableNode,g=0,f=0,g=a.rows.length,b=0;b<g;b++)e=a.rows[b].cells.length,f<e&&(f=e);g==c&&(document.getElementById("radio_3").removeAttribute("disabled"),document.getElementById("radio_4").removeAttribute("disabled"));f==d&&(document.getElementById("radio_5").removeAttribute("disabled"),
document.getElementById("radio_6").removeAttribute("disabled"))}function keditor_load_auto_save_open(a,c,d){return LayerWin.event_keditor_load_auto_save_open(a,c,d)}function keditor_load_auto_save(){LayerWin.event_keditor_load_auto_save(g_currHtml,window.frameElement.parentNode.parentNode,g_currEditorId)}function keditor_load_auto_save_del(a,c,d,b){a="keditor_"+a;""!=c&&(a+="_"+c);LayerWin.event_keditor_load_auto_save_del(a,d,window.frameElement.parentNode.parentNode,b)}
function keditor_load_auto_save_setDateList(){var a=keditor_load_auto_save_open(KEDITORTOP.G_CURRKEDITOR.ID,KEDITORTOP.G_CURRKEDITOR._config.setAutoSave.unique_key,KEDITORTOP.G_CURRKEDITOR._config.setAutoSave.maxCount);if(null!=a&&void 0!=a&&0<a.length)for(var c=document.getElementById("ul_date"),d=a.length-1;0<=d;d--){var b=document.createElement("li");b.style.cursor="pointer";var e=document.createElement("span");e.className="icon";var g=document.createElement("img");g.src="../images/bg/editor_popup_close_bg.gif";
g.width="10";g.height="10";g.style.cursor="pointer";e.appendChild(g);var f=document.createElement("span");f.className="text";var g=a[d].date.split(" "),h=g[0].split("/");f.innerHTML=h[2]+"/"+h[0]+"/"+h[1]+" "+g[1];g=document.createElement("a");g.appendChild(f);g.href="javascript:void(0)";g.style.textDecoration="none";f=document.createElement("a");f.appendChild(e);f.href="javascript:void(0)";f.style.textDecoration="none";b.appendChild(g);b.appendChild(f);c.appendChild(b);e=function(b){return function(c){keditor_load_auto_save_click_date(b,
a);KEDITORTOP.RAONKEDITOR.util.stopEvent(c)}}(d);KEDITORTOP.RAONKEDITOR.util.addEvent(b,"click",e);KEDITORTOP.RAONKEDITOR.util.addEvent(g,"focus",e);b=function(a){return function(a){13==("which"in a?a.which:a.keyCode)&&(KEDITORTOP.RAONKEDITOR.util.cancelEvent(a),keditor_load_auto_save())}}(g);KEDITORTOP.RAONKEDITOR.util.addEvent(g,"keydown",b);"cssFloat"in g.style?g.style.cssFloat="left":g.style.styleFloat="left";"cssFloat"in f.style?f.style.cssFloat="left":f.style.styleFloat="left";b=function(b){return function(c){keditor_load_auto_save_click_date(b,
a);keditor_load_auto_save_click_del(KEDITORTOP.G_CURRKEDITOR.ID,KEDITORTOP.G_CURRKEDITOR._config.setAutoSave.unique_key,b,KEDITORTOP.G_CURRKEDITOR._config.setAutoSave.maxCount);KEDITORTOP.RAONKEDITOR.util.stopEvent(c)}}(d);KEDITORTOP.RAONKEDITOR.util.addEvent(f,"click",b);setCursorPos(document.getElementById("ul_date").getElementsByTagName("a")[0],!1,!1);LayerWin.setFocusFirstAndLast(document,document.getElementById("ul_date").getElementsByTagName("a")[0])}else keditor_load_auto_save_setHtml("<html><head></head><body></body></html>")}
function keditor_load_auto_save_click_date(a,c){for(var d=document.getElementById("ul_date"),b=d.getElementsByTagName("li").length-1,e=b;0<=e;e--){var g=b-e;e==a?d.getElementsByTagName("li")[g].style.backgroundColor="#dff1ff":d.getElementsByTagName("li")[g].style.backgroundColor="#ffffff";d.getElementsByTagName("li")[g].getElementsByTagName("img")[0].src="../images/bg/editor_popup_close_bg.gif"}0<d.getElementsByTagName("li").length&&keditor_load_auto_save_setHtml(c[a].html);g_currEditorId=c[a].id}
function keditor_load_auto_save_setHtml(a){var c=document.getElementById("content_frame").contentWindow.document;g_currHtml=a;"1"==KEDITORTOP.G_CURRKEDITOR._config.enforceDoctype&&(g_currHtml=g_currHtml.replace(/<!doctype *([^>?+])*>/gi,""));a=LayerWin.getRemoveHeadScript(g_currHtml);g_currHtml=a.html;c.open("text/html","replace");LayerWin.isCustomDomain(LayerWin.document)&&(c.domain=LayerWin.document.domain);c.write(g_currHtml);c.close();LayerWin.setHeadScriptSrc(c,a.scriptsAry);a=Math.max(c.body.scrollWidth,
c.body.offsetWidth,c.documentElement.clientWidth,c.documentElement.scrollWidth,c.documentElement.offsetWidth);var d=Math.max(c.body.scrollHeight,c.body.offsetHeight,c.documentElement.clientHeight,c.documentElement.scrollHeight,c.documentElement.offsetHeight),b=document.getElementById("content_frame").parentNode,e=LayerWin.getClientRect(b),b=e.right-e.left,e=e.bottom-e.top,g=!0;KEDITORTOP.RAONKEDITOR.browser.ie&&7>=KEDITORTOP.RAONKEDITOR.browser.ieVersion&&(g=!1);a>b?(c.body.style.width=KEDITORTOP.G_CURRKEDITOR._config.style.width,
g&&(c.body.style.overflowX="scroll")):g&&(c.body.style.overflowX="hidden");d>e?g&&(c.body.style.overflowY="scroll"):g&&(c.body.style.overflowY="hidden");KEDITORTOP.RAONKEDITOR.util.addEvent(c,"contextmenu",function(a){KEDITORTOP.RAONKEDITOR.util.cancelEvent(a)})}
function keditor_load_auto_save_click_del(a,c,d,b){var e=document.getElementById("ul_date");if(confirm(LayerWin.RAONKEditor_lang.loadAutoSave.delMsg)){for(keditor_load_auto_save_del(a,c,d,b);e.hasChildNodes();)e.removeChild(e.firstChild);keditor_load_auto_save_setDateList()}}
function about_set_license(){try{document.getElementById("keditor_license_company").innerHTML=": "+LayerWin._k_editor.____.l[1],document.getElementById("keditor_license_system").innerHTML=": "+LayerWin._k_editor.____.l[2],document.getElementById("keditor_license_product").innerHTML=": "+LayerWin._k_editor.____.l[0],"S"==LayerWin._k_editor.____.l[8]?document.getElementById("keditor_license_edition").innerHTML=": Standard Edition":document.getElementById("keditor_license_edition").innerHTML=": Professional Edition",
0==LayerWin._k_editor.____.l[5]?document.getElementById("keditor_license_user").innerHTML=": Unlimited.":document.getElementById("keditor_license_user").innerHTML=": "+LayerWin._k_editor.____.l[5],document.getElementById("keditor_license_ver").innerHTML=": "+KEDITORTOP.RAONKEDITOR.ReleaseVer}catch(a){}}KEDITORTOP.RAONKEDITOR.util.addEvent(window,"dragover",function(a){KEDITORTOP.RAONKEDITOR.util.cancelEvent(a)});KEDITORTOP.RAONKEDITOR.util.addEvent(document,"dragover",function(a){KEDITORTOP.RAONKEDITOR.util.cancelEvent(a)});
KEDITORTOP.RAONKEDITOR.util.addEvent(window,"drop",function(a){KEDITORTOP.RAONKEDITOR.util.cancelEvent(a)});KEDITORTOP.RAONKEDITOR.util.addEvent(document,"drop",function(a){KEDITORTOP.RAONKEDITOR.util.cancelEvent(a)});"undefined"==typeof useContextmenu&&KEDITORTOP.RAONKEDITOR.util.addEvent(document,"contextmenu",function(a){KEDITORTOP.RAONKEDITOR.util.cancelEvent(a)});function kplugin_action(a){LayerWin.event_kplugin_action(a,window.frameElement.parentNode.parentNode)}
function setInputBoxWidth(a,c){c=KEDITORTOP.RAONKEDITOR.util.parseIntOr0(c);KEDITORTOP.RAONKEDITOR.browser.mobile&&(a.style.width=KEDITORTOP.RAONKEDITOR.browser.safari?c-10+"px":c+"px")}
function keditor_spellcheck_set_popup(a,c){if(0==a.length)return!1;try{for(var d=LayerWin.rangy.createRange(document.getElementById("copycontent").contentDocument),b=0;b<a.length;b++)if(d.findText(a[b].word)){d.deleteContents();var e=document.createElement("span");e.setAttribute("id","cnt"+b);e.setAttribute("class","cnt");e.setAttribute("onmouseover","parent.wrong_word_over(this)");e.setAttribute("onmouseout","parent.wrong_word_out(this)");var g=document.createElement("span");g.setAttribute("class",
"cnt_modify");g.setAttribute("title","\uc801\uc6a9\ud558\uae30");g.setAttribute("onclick","parent.above_word_click(this)");g.innerHTML=a[b].suggestions[0];e.appendChild(g);var f=document.createTextNode(a[b].word),h=document.createElement("sup"),k=document.createTextNode(b+1+")");h.appendChild(k);e.appendChild(h);e.appendChild(f);d.insertNode(e);d.selectNode(e);c?d.collapse(!1):d.collapse(!0);var l=document.createElement("dl");l.setAttribute("id","list"+b);l.setAttribute("value",b);-1!=LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word.indexOf("'")?
l.innerHTML='<dt onclick="wrong_word_click(this)"><a data-value="'+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word+'">'+(b+1)+") "+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word+"</a></dt>":l.innerHTML="<dt onclick='wrong_word_click(this)'><a data-value='"+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word+"'>"+(b+1)+") "+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word+"</a></dt>";document.getElementById("wordlist").appendChild(l);for(var m=0;m<LayerWin.G_KPlugin.spellcheck.chkWordArr[b].suggestions.length;m++){var p=
document.createElement("dd");p.setAttribute("onclick","replace_word_click(this)");p.innerHTML="<a value='"+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].suggestions[m]+"'>"+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].suggestions[m]+"</a></dt>";document.getElementById("list"+b).appendChild(p)}l.getElementsByTagName("dd")[0].setAttribute("class","recommend")}else{var n=a[b].word,n=n.replace(/ /gi,"\u00a0");if(d.findText(n)){d.deleteContents();e=document.createElement("span");e.setAttribute("id","cnt"+
b);e.setAttribute("class","cnt");e.setAttribute("onmouseover","parent.wrong_word_over(this)");e.setAttribute("onmouseout","parent.wrong_word_out(this)");g=document.createElement("span");g.setAttribute("class","cnt_modify");g.setAttribute("title","\uc801\uc6a9\ud558\uae30");g.setAttribute("onclick","parent.above_word_click(this)");g.innerHTML=a[b].suggestions[0];e.appendChild(g);f=document.createTextNode(a[b].word);h=document.createElement("sup");k=document.createTextNode(b+1+")");h.appendChild(k);
e.appendChild(h);e.appendChild(f);d.insertNode(e);d.selectNode(e);c?d.collapse(!1):d.collapse(!0);l=document.createElement("dl");l.setAttribute("id","list"+b);l.setAttribute("value",b);-1!=LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word.indexOf("'")?l.innerHTML='<dt onclick="wrong_word_click(this)"><a data-value="'+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word+'">'+(b+1)+") "+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word+"</a></dt>":l.innerHTML="<dt onclick='wrong_word_click(this)'><a data-value='"+
LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word+"'>"+(b+1)+") "+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].word+"</a></dt>";document.getElementById("wordlist").appendChild(l);for(m=0;m<LayerWin.G_KPlugin.spellcheck.chkWordArr[b].suggestions.length;m++)p=document.createElement("dd"),p.setAttribute("onclick","replace_word_click(this)"),p.innerHTML="<a value='"+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].suggestions[m]+"'>"+LayerWin.G_KPlugin.spellcheck.chkWordArr[b].suggestions[m]+"</a></dt>",document.getElementById("list"+
b).appendChild(p);l.getElementsByTagName("dd")[0].setAttribute("class","recommend")}else LayerWin.G_KPlugin.spellcheck.chkWordArr.splice(b,1),b--}LayerWin.hideProcessingBackground()}catch(q){}}
function imgSizeUnitChange(a,c){var d=document.getElementById("img_height_unit"),b=document.getElementById("img_width_unit"),e=document.getElementById("img_width"),g=document.getElementById("img_height"),f=document.getElementById("img_ratio");"true"==f.getAttribute("ratio-checked")?(b.value=a,d.value=a,"%"==a?"w"==c?(e.value="100",g.value="",g.setAttribute("disabled","true")):(g.value="100",e.value="",e.setAttribute("disabled","true")):(e.removeAttribute("disabled"),g.removeAttribute("disabled"))):
b.value==d.value?f.removeAttribute("disabled"):(f.className="img_link_btn",f.setAttribute("ratio-checked",!1),f.setAttribute("disabled","true"),e.removeAttribute("disabled"),g.removeAttribute("disabled"))}
function checkSameBorderWidthInCells(a,c){var d=["borderLeftWidth","borderTopWidth","borderRightWidth","borderBottomWidth"],b=d.length,e={isSame:!0,borderWidth:""};try{if(c){a=[];for(var g=["td","th"],f=g.length,h=0;h<f;h++){var k=c.getElementsByTagName(g[h]);try{a=a.concat(Array.prototype.slice.call(k,0))}catch(l){for(var m=k.length,p=0;p<m;p++)a.push(k[p])}}}var n=a.length;if(500>=n){for(var q=a[0].style.borderLeftWidth,h=0;h<n;h++)for(var r=a[h],p=0;p<b;p++)if(q!=r.style[d[p]]){e.isSame=!1;break}1==
e.isSame&&(e.borderWidth=q)}else e={isSame:!1,borderWidth:""}}catch(t){e={isSame:!1,borderWidth:""}}return e}function changeStyleForiOS(a,c){if(KEDITORTOP.RAONKEDITOR.browser.iOS)for(data in a.style.webkitAppearance="none",c){a.style[data]=c[data];break}};
